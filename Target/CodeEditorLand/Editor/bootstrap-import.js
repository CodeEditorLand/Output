import{fileURLToPath as l,pathToFileURL as a}from"node:url";import{promises as s}from"node:fs";import{join as c}from"node:path";const m={};async function u(n){const r=l(new URL("../package.json",a(n))),t=JSON.parse(String(await s.readFile(r)));for(const[e]of Object.entries(t.dependencies))try{const i=c(r,`../node_modules/${e}/package.json`);let{main:o}=JSON.parse(String(await s.readFile(i)));o||(o="index.js"),o.endsWith(".js")||(o+=".js");const d=c(r,`../node_modules/${e}/${o}`);m[e]=a(d).href}catch{}}async function h(n,r,t){const e=m[n];return e!==void 0?{format:"commonjs",shortCircuit:!0,url:e}:t(n,r)}export{u as initialize,h as resolve};
