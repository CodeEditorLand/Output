{
  "version": 3,
  "sources": ["../../../../../../../../../../../Dependency/Land/Dependency/Editor/Source/vs/editor/contrib/inlineCompletions/browser/model/provideInlineCompletions.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { assertNever } from '../../../../../base/common/assert.js';\nimport { AsyncIterableObject, DeferredPromise } from '../../../../../base/common/async.js';\nimport { CancellationToken, CancellationTokenSource } from '../../../../../base/common/cancellation.js';\nimport { onUnexpectedExternalError } from '../../../../../base/common/errors.js';\nimport { Disposable, IDisposable } from '../../../../../base/common/lifecycle.js';\nimport { SetMap } from '../../../../../base/common/map.js';\nimport { ISingleEditOperation } from '../../../../common/core/editOperation.js';\nimport { OffsetRange } from '../../../../common/core/offsetRange.js';\nimport { Position } from '../../../../common/core/position.js';\nimport { Range } from '../../../../common/core/range.js';\nimport { SingleTextEdit } from '../../../../common/core/textEdit.js';\nimport { LanguageFeatureRegistry } from '../../../../common/languageFeatureRegistry.js';\nimport { Command, InlineCompletion, InlineCompletionContext, InlineCompletionProviderGroupId, InlineCompletions, InlineCompletionsProvider, InlineCompletionTriggerKind } from '../../../../common/languages.js';\nimport { ILanguageConfigurationService } from '../../../../common/languages/languageConfigurationRegistry.js';\nimport { ITextModel } from '../../../../common/model.js';\nimport { fixBracketsInLine } from '../../../../common/model/bracketPairsTextModelPart/fixBrackets.js';\nimport { TextModelText } from '../../../../common/model/textModelText.js';\nimport { LineEditWithAdditionalLines } from '../../../../common/tokenizationTextModelPart.js';\nimport { SnippetParser, Text } from '../../../snippet/browser/snippetParser.js';\nimport { getReadonlyEmptyArray } from '../utils.js';\n\nexport async function provideInlineCompletions(\n\tregistry: LanguageFeatureRegistry<InlineCompletionsProvider>,\n\tpositionOrRange: Position | Range,\n\tmodel: ITextModel,\n\tcontext: InlineCompletionContext,\n\tbaseToken: CancellationToken = CancellationToken.None,\n\tlanguageConfigurationService?: ILanguageConfigurationService,\n): Promise<InlineCompletionProviderResult> {\n\tconst tokenSource = new CancellationTokenSource(baseToken);\n\tconst token = tokenSource.token;\n\n\tconst defaultReplaceRange = positionOrRange instanceof Position ? getDefaultRange(positionOrRange, model) : positionOrRange;\n\tconst providers = registry.all(model);\n\n\tconst multiMap = new SetMap<InlineCompletionProviderGroupId, InlineCompletionsProvider<any>>();\n\tfor (const provider of providers) {\n\t\tif (provider.groupId) {\n\t\t\tmultiMap.add(provider.groupId, provider);\n\t\t}\n\t}\n\n\tfunction getPreferredProviders(provider: InlineCompletionsProvider<any>): InlineCompletionsProvider<any>[] {\n\t\tif (!provider.yieldsToGroupIds) { return []; }\n\t\tconst result: InlineCompletionsProvider<any>[] = [];\n\t\tfor (const groupId of provider.yieldsToGroupIds || []) {\n\t\t\tconst providers = multiMap.get(groupId);\n\t\t\tfor (const p of providers) {\n\t\t\t\tresult.push(p);\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\ttype Result = Promise<InlineCompletionList | undefined>;\n\tconst states = new Map<InlineCompletionsProvider, Result>();\n\n\tconst seen = new Set<InlineCompletionsProvider>();\n\tfunction findPreferredProviderCircle(\n\t\tprovider: InlineCompletionsProvider<any>,\n\t\tstack: InlineCompletionsProvider[]\n\t): InlineCompletionsProvider[] | undefined {\n\t\tstack = [...stack, provider];\n\t\tif (seen.has(provider)) { return stack; }\n\n\t\tseen.add(provider);\n\t\ttry {\n\t\t\tconst preferred = getPreferredProviders(provider);\n\t\t\tfor (const p of preferred) {\n\t\t\t\tconst c = findPreferredProviderCircle(p, stack);\n\t\t\t\tif (c) { return c; }\n\t\t\t}\n\t\t} finally {\n\t\t\tseen.delete(provider);\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tfunction queryProviderOrPreferredProvider(provider: InlineCompletionsProvider<InlineCompletions>): Result {\n\t\tconst state = states.get(provider);\n\t\tif (state) { return state; }\n\n\t\tconst circle = findPreferredProviderCircle(provider, []);\n\t\tif (circle) {\n\t\t\tonUnexpectedExternalError(new Error(`Inline completions: cyclic yield-to dependency detected.`\n\t\t\t\t+ ` Path: ${circle.map(s => s.toString ? s.toString() : ('' + s)).join(' -> ')}`));\n\t\t}\n\n\t\tconst deferredPromise = new DeferredPromise<InlineCompletionList | undefined>();\n\t\tstates.set(provider, deferredPromise.p);\n\n\t\t(async () => {\n\t\t\tif (!circle) {\n\t\t\t\tconst preferred = getPreferredProviders(provider);\n\t\t\t\tfor (const p of preferred) {\n\t\t\t\t\tconst result = await queryProviderOrPreferredProvider(p);\n\t\t\t\t\tif (result && result.inlineCompletions.items.length > 0) {\n\t\t\t\t\t\t// Skip provider\n\t\t\t\t\t\treturn undefined;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn query(provider);\n\t\t})().then(c => deferredPromise.complete(c), e => deferredPromise.error(e));\n\n\t\treturn deferredPromise.p;\n\t}\n\n\tasync function query(provider: InlineCompletionsProvider): Promise<InlineCompletionList | undefined> {\n\t\tlet result: InlineCompletions | null | undefined;\n\t\ttry {\n\t\t\tif (positionOrRange instanceof Position) {\n\t\t\t\tresult = await provider.provideInlineCompletions(model, positionOrRange, context, token);\n\t\t\t} else {\n\t\t\t\tresult = await provider.provideInlineEditsForRange?.(model, positionOrRange, context, token);\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tonUnexpectedExternalError(e);\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (!result) { return undefined; }\n\t\tconst list = new InlineCompletionList(result, provider);\n\n\t\trunWhenCancelled(token, () => list.removeRef());\n\t\treturn list;\n\t}\n\n\tconst inlineCompletionLists = AsyncIterableObject.fromPromisesResolveOrder(providers.map(queryProviderOrPreferredProvider));\n\n\tif (token.isCancellationRequested) {\n\t\ttokenSource.dispose(true);\n\t\t// result has been disposed before we could call addRef! So we have to discard everything.\n\t\treturn new InlineCompletionProviderResult([], new Set(), []);\n\t}\n\n\tconst result = await addRefAndCreateResult(context, inlineCompletionLists, defaultReplaceRange, model, languageConfigurationService);\n\ttokenSource.dispose(true); // This disposes results that are not referenced.\n\treturn result;\n}\n\n/** If the token does not leak, this will not leak either. */\nfunction runWhenCancelled(token: CancellationToken, callback: () => void): IDisposable {\n\tif (token.isCancellationRequested) {\n\t\tcallback();\n\t\treturn Disposable.None;\n\t} else {\n\t\tconst listener = token.onCancellationRequested(() => {\n\t\t\tlistener.dispose();\n\t\t\tcallback();\n\t\t});\n\t\treturn { dispose: () => listener.dispose() };\n\t}\n}\n\n// TODO: check cancellation token!\nasync function addRefAndCreateResult(\n\tcontext: InlineCompletionContext,\n\tinlineCompletionLists: AsyncIterable<(InlineCompletionList | undefined)>,\n\tdefaultReplaceRange: Range,\n\tmodel: ITextModel,\n\tlanguageConfigurationService: ILanguageConfigurationService | undefined\n): Promise<InlineCompletionProviderResult> {\n\t// for deduplication\n\tconst itemsByHash = new Map<string, InlineCompletionItem>();\n\n\tlet shouldStop = false;\n\tconst lists: InlineCompletionList[] = [];\n\tfor await (const completions of inlineCompletionLists) {\n\t\tif (!completions) { continue; }\n\t\tcompletions.addRef();\n\t\tfor (const item of completions.inlineCompletions.items) {\n\t\t\tconst inlineCompletionItem = InlineCompletionItem.from(\n\t\t\t\titem,\n\t\t\t\tcompletions,\n\t\t\t\tdefaultReplaceRange,\n\t\t\t\tmodel,\n\t\t\t\tlanguageConfigurationService\n\t\t\t);\n\t\t\titemsByHash.set(inlineCompletionItem.hash(), inlineCompletionItem);\n\n\t\t\tif (context.triggerKind === InlineCompletionTriggerKind.Automatic) {\n\t\t\t\tconst minifiedEdit = inlineCompletionItem.toSingleTextEdit().removeCommonPrefix(new TextModelText(model));\n\t\t\t\tif (!minifiedEdit.isEmpty) {\n\t\t\t\t\tshouldStop = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (shouldStop) {\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn new InlineCompletionProviderResult(Array.from(itemsByHash.values()), new Set(itemsByHash.keys()), lists);\n}\n\nexport class InlineCompletionProviderResult implements IDisposable {\n\n\tconstructor(\n\t\t/**\n\t\t * Free of duplicates.\n\t\t */\n\t\tpublic readonly completions: readonly InlineCompletionItem[],\n\t\tprivate readonly hashs: Set<string>,\n\t\tprivate readonly providerResults: readonly InlineCompletionList[],\n\t) { }\n\n\tpublic has(item: InlineCompletionItem): boolean {\n\t\treturn this.hashs.has(item.hash());\n\t}\n\n\tdispose(): void {\n\t\tfor (const result of this.providerResults) {\n\t\t\tresult.removeRef();\n\t\t}\n\t}\n}\n\n/**\n * A ref counted pointer to the computed `InlineCompletions` and the `InlineCompletionsProvider` that\n * computed them.\n */\nexport class InlineCompletionList {\n\tprivate refCount = 1;\n\tconstructor(\n\t\tpublic readonly inlineCompletions: InlineCompletions,\n\t\tpublic readonly provider: InlineCompletionsProvider,\n\t) { }\n\n\taddRef(): void {\n\t\tthis.refCount++;\n\t}\n\n\tremoveRef(): void {\n\t\tthis.refCount--;\n\t\tif (this.refCount === 0) {\n\t\t\tthis.provider.freeInlineCompletions(this.inlineCompletions);\n\t\t}\n\t}\n}\n\nexport class InlineCompletionItem {\n\tpublic static from(\n\t\tinlineCompletion: InlineCompletion,\n\t\tsource: InlineCompletionList,\n\t\tdefaultReplaceRange: Range,\n\t\ttextModel: ITextModel,\n\t\tlanguageConfigurationService: ILanguageConfigurationService | undefined,\n\t) {\n\t\tlet insertText: string;\n\t\tlet snippetInfo: SnippetInfo | undefined;\n\t\tlet range = inlineCompletion.range ? Range.lift(inlineCompletion.range) : defaultReplaceRange;\n\n\t\tif (typeof inlineCompletion.insertText === 'string') {\n\t\t\tinsertText = inlineCompletion.insertText;\n\n\t\t\tif (languageConfigurationService && inlineCompletion.completeBracketPairs) {\n\t\t\t\tinsertText = closeBrackets(\n\t\t\t\t\tinsertText,\n\t\t\t\t\trange.getStartPosition(),\n\t\t\t\t\ttextModel,\n\t\t\t\t\tlanguageConfigurationService\n\t\t\t\t);\n\n\t\t\t\t// Modify range depending on if brackets are added or removed\n\t\t\t\tconst diff = insertText.length - inlineCompletion.insertText.length;\n\t\t\t\tif (diff !== 0) {\n\t\t\t\t\trange = new Range(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn + diff);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tsnippetInfo = undefined;\n\t\t} else if ('snippet' in inlineCompletion.insertText) {\n\t\t\tconst preBracketCompletionLength = inlineCompletion.insertText.snippet.length;\n\n\t\t\tif (languageConfigurationService && inlineCompletion.completeBracketPairs) {\n\t\t\t\tinlineCompletion.insertText.snippet = closeBrackets(\n\t\t\t\t\tinlineCompletion.insertText.snippet,\n\t\t\t\t\trange.getStartPosition(),\n\t\t\t\t\ttextModel,\n\t\t\t\t\tlanguageConfigurationService\n\t\t\t\t);\n\n\t\t\t\t// Modify range depending on if brackets are added or removed\n\t\t\t\tconst diff = inlineCompletion.insertText.snippet.length - preBracketCompletionLength;\n\t\t\t\tif (diff !== 0) {\n\t\t\t\t\trange = new Range(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn + diff);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst snippet = new SnippetParser().parse(inlineCompletion.insertText.snippet);\n\n\t\t\tif (snippet.children.length === 1 && snippet.children[0] instanceof Text) {\n\t\t\t\tinsertText = snippet.children[0].value;\n\t\t\t\tsnippetInfo = undefined;\n\t\t\t} else {\n\t\t\t\tinsertText = snippet.toString();\n\t\t\t\tsnippetInfo = {\n\t\t\t\t\tsnippet: inlineCompletion.insertText.snippet,\n\t\t\t\t\trange: range\n\t\t\t\t};\n\t\t\t}\n\t\t} else {\n\t\t\tassertNever(inlineCompletion.insertText);\n\t\t}\n\n\t\treturn new InlineCompletionItem(\n\t\t\tinsertText,\n\t\t\tinlineCompletion.command,\n\t\t\trange,\n\t\t\tinsertText,\n\t\t\tsnippetInfo,\n\t\t\tinlineCompletion.additionalTextEdits || getReadonlyEmptyArray(),\n\t\t\tinlineCompletion,\n\t\t\tsource,\n\t\t);\n\t}\n\n\tconstructor(\n\t\treadonly filterText: string,\n\t\treadonly command: Command | undefined,\n\t\treadonly range: Range,\n\t\treadonly insertText: string,\n\t\treadonly snippetInfo: SnippetInfo | undefined,\n\n\t\treadonly additionalTextEdits: readonly ISingleEditOperation[],\n\n\n\t\t/**\n\t\t * A reference to the original inline completion this inline completion has been constructed from.\n\t\t * Used for event data to ensure referential equality.\n\t\t*/\n\t\treadonly sourceInlineCompletion: InlineCompletion,\n\n\t\t/**\n\t\t * A reference to the original inline completion list this inline completion has been constructed from.\n\t\t * Used for event data to ensure referential equality.\n\t\t*/\n\t\treadonly source: InlineCompletionList,\n\t) {\n\t\tfilterText = filterText.replace(/\\r\\n|\\r/g, '\\n');\n\t\tinsertText = filterText.replace(/\\r\\n|\\r/g, '\\n');\n\t}\n\n\tpublic withRange(updatedRange: Range): InlineCompletionItem {\n\t\treturn new InlineCompletionItem(\n\t\t\tthis.filterText,\n\t\t\tthis.command,\n\t\t\tupdatedRange,\n\t\t\tthis.insertText,\n\t\t\tthis.snippetInfo,\n\t\t\tthis.additionalTextEdits,\n\t\t\tthis.sourceInlineCompletion,\n\t\t\tthis.source,\n\t\t);\n\t}\n\n\tpublic hash(): string {\n\t\treturn JSON.stringify({ insertText: this.insertText, range: this.range.toString() });\n\t}\n\n\tpublic toSingleTextEdit(): SingleTextEdit {\n\t\treturn new SingleTextEdit(this.range, this.insertText);\n\t}\n}\n\nexport interface SnippetInfo {\n\tsnippet: string;\n\t/* Could be different than the main range */\n\trange: Range;\n}\n\nfunction getDefaultRange(position: Position, model: ITextModel): Range {\n\tconst word = model.getWordAtPosition(position);\n\tconst maxColumn = model.getLineMaxColumn(position.lineNumber);\n\t// By default, always replace up until the end of the current line.\n\t// This default might be subject to change!\n\treturn word\n\t\t? new Range(position.lineNumber, word.startColumn, position.lineNumber, maxColumn)\n\t\t: Range.fromPositions(position, position.with(undefined, maxColumn));\n}\n\nfunction closeBrackets(text: string, position: Position, model: ITextModel, languageConfigurationService: ILanguageConfigurationService): string {\n\tconst lineStart = model.getLineContent(position.lineNumber).substring(0, position.column - 1);\n\tconst newLine = lineStart + text;\n\n\tconst edit = LineEditWithAdditionalLines.replace(OffsetRange.ofStartAndLength(position.column - 1, newLine.length - (position.column - 1)), text);\n\tconst newTokens = model.tokenization.tokenizeLineWithEdit(position.lineNumber, edit);\n\tconst slicedTokens = newTokens?.mainLineTokens?.sliceAndInflate(position.column - 1, newLine.length, 0);\n\tif (!slicedTokens) {\n\t\treturn text;\n\t}\n\n\tconst newText = fixBracketsInLine(slicedTokens, languageConfigurationService);\n\n\treturn newText;\n}\n"],
  "mappings": "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",
  "names": ["result", "providers"]
}
