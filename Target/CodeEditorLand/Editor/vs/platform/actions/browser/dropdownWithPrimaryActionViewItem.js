var I=Object.defineProperty;var f=Object.getOwnPropertyDescriptor;var l=(a,d,e,o)=>{for(var i=o>1?void 0:o?f(d,e):d,n=a.length-1,t;n>=0;n--)(t=a[n])&&(i=(o?t(d,e,i):t(i))||i);return o&&i&&I(d,e,i),i},s=(a,d)=>(e,o)=>d(e,o,a);import*as r from"../../../base/browser/dom.js";import{StandardKeyboardEvent as m}from"../../../base/browser/keyboardEvent.js";import{BaseActionViewItem as g}from"../../../base/browser/ui/actionbar/actionViewItems.js";import{DropdownMenuActionViewItem as h}from"../../../base/browser/ui/dropdown/dropdownActionViewItem.js";import"../../../base/common/actions.js";import"../../../base/common/event.js";import{KeyCode as u}from"../../../base/common/keyCodes.js";import"../../../base/common/keybindings.js";import{MenuEntryActionViewItem as C}from"./menuEntryActionViewItem.js";import"../common/actions.js";import{IContextKeyService as D}from"../../contextkey/common/contextkey.js";import{IKeybindingService as x}from"../../keybinding/common/keybinding.js";import{INotificationService as K}from"../../notification/common/notification.js";import{IThemeService as R}from"../../theme/common/themeService.js";import{IContextMenuService as E}from"../../contextview/browser/contextView.js";import{IAccessibilityService as M}from"../../accessibility/common/accessibility.js";import"../../../base/browser/ui/hover/hoverDelegate.js";let c=class extends g{constructor(e,o,i,n,t,v,p,_,y,A,w){super(null,e,{hoverDelegate:t?.hoverDelegate});this._options=t;this._contextMenuProvider=v;this._primaryAction=new C(e,{hoverDelegate:t?.hoverDelegate},p,_,y,A,v,w),t?.actionRunner&&(this._primaryAction.actionRunner=t.actionRunner),this._dropdown=new h(o,i,this._contextMenuProvider,{menuAsChild:t?.menuAsChild??!0,classNames:n?["codicon","codicon-chevron-down",n]:["codicon","codicon-chevron-down"],actionRunner:this._options?.actionRunner,keybindingProvider:this._options?.getKeyBinding??(b=>p.lookupKeybinding(b.id)),hoverDelegate:t?.hoverDelegate,skipTelemetry:t?.skipTelemetry})}_primaryAction;_dropdown;_container=null;_dropdownContainer=null;get onDidChangeDropdownVisibility(){return this._dropdown.onDidChangeVisibility}set actionRunner(e){super.actionRunner=e,this._primaryAction.actionRunner=e,this._dropdown.actionRunner=e}setActionContext(e){super.setActionContext(e),this._primaryAction.setActionContext(e),this._dropdown.setActionContext(e)}render(e){this._container=e,super.render(this._container),this._container.classList.add("monaco-dropdown-with-primary");const o=r.$(".action-container");o.role="button",this._primaryAction.render(r.append(this._container,o)),this._dropdownContainer=r.$(".dropdown-action-container"),this._dropdown.render(r.append(this._container,this._dropdownContainer)),this._register(r.addDisposableListener(o,r.EventType.KEY_DOWN,i=>{const n=new m(i);n.equals(u.RightArrow)&&(this._primaryAction.element.tabIndex=-1,this._dropdown.focus(),n.stopPropagation())})),this._register(r.addDisposableListener(this._dropdownContainer,r.EventType.KEY_DOWN,i=>{const n=new m(i);n.equals(u.LeftArrow)&&(this._primaryAction.element.tabIndex=0,this._dropdown.setFocusable(!1),this._primaryAction.element?.focus(),n.stopPropagation())})),this.updateEnabled()}focus(e){e?this._dropdown.focus():(this._primaryAction.element.tabIndex=0,this._primaryAction.element.focus())}blur(){this._primaryAction.element.tabIndex=-1,this._dropdown.blur(),this._container.blur()}setFocusable(e){e?this._primaryAction.element.tabIndex=0:(this._primaryAction.element.tabIndex=-1,this._dropdown.setFocusable(!1))}updateEnabled(){const e=!this.action.enabled;this.element?.classList.toggle("disabled",e)}update(e,o,i){this._dropdown.dispose(),this._dropdown=new h(e,o,this._contextMenuProvider,{menuAsChild:!0,classNames:["codicon",i||"codicon-chevron-down"],actionRunner:this._options?.actionRunner,hoverDelegate:this._options?.hoverDelegate,keybindingProvider:this._options?.getKeyBinding}),this._dropdownContainer&&this._dropdown.render(this._dropdownContainer)}dispose(){this._primaryAction.dispose(),this._dropdown.dispose(),super.dispose()}};c=l([s(5,E),s(6,x),s(7,K),s(8,D),s(9,R),s(10,M)],c);export{c as DropdownWithPrimaryActionViewItem};
