{
  "version": 3,
  "sources": ["../../../../../../../../../../../Dependency/Land/Dependency/Editor/Source/vs/workbench/contrib/chat/browser/actions/chatContextActions.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { CancellationToken } from '../../../../../base/common/cancellation.js';\nimport { Codicon } from '../../../../../base/common/codicons.js';\nimport { KeyCode, KeyMod } from '../../../../../base/common/keyCodes.js';\nimport { Schemas } from '../../../../../base/common/network.js';\nimport { compare } from '../../../../../base/common/strings.js';\nimport { ThemeIcon } from '../../../../../base/common/themables.js';\nimport { URI } from '../../../../../base/common/uri.js';\nimport { ServicesAccessor } from '../../../../../editor/browser/editorExtensions.js';\nimport { IRange } from '../../../../../editor/common/core/range.js';\nimport { EditorType } from '../../../../../editor/common/editorCommon.js';\nimport { Command } from '../../../../../editor/common/languages.js';\nimport { AbstractGotoSymbolQuickAccessProvider, IGotoSymbolQuickPickItem } from '../../../../../editor/contrib/quickAccess/browser/gotoSymbolQuickAccess.js';\nimport { localize, localize2 } from '../../../../../nls.js';\nimport { Action2, MenuId, registerAction2 } from '../../../../../platform/actions/common/actions.js';\nimport { IClipboardService } from '../../../../../platform/clipboard/common/clipboardService.js';\nimport { ICommandService } from '../../../../../platform/commands/common/commands.js';\nimport { IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { ContextKeyExpr, IContextKeyService } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { KeybindingWeight } from '../../../../../platform/keybinding/common/keybindingsRegistry.js';\nimport { ILabelService } from '../../../../../platform/label/common/label.js';\nimport { AnythingQuickAccessProviderRunOptions } from '../../../../../platform/quickinput/common/quickAccess.js';\nimport { IQuickInputService, IQuickPickItem, IQuickPickItemWithResource, IQuickPickSeparator, QuickPickItem } from '../../../../../platform/quickinput/common/quickInput.js';\nimport { ActiveEditorContext } from '../../../../common/contextkeys.js';\nimport { IEditorService } from '../../../../services/editor/common/editorService.js';\nimport { IViewsService } from '../../../../services/views/common/viewsService.js';\nimport { AnythingQuickAccessProvider } from '../../../search/browser/anythingQuickAccess.js';\nimport { ISymbolQuickPickItem, SymbolsQuickAccessProvider } from '../../../search/browser/symbolsQuickAccess.js';\nimport { SearchContext } from '../../../search/common/constants.js';\nimport { VIEW_ID as SEARCH_VIEW_ID } from '../../../../services/search/common/search.js';\nimport { ChatAgentLocation, IChatAgentService } from '../../common/chatAgents.js';\nimport { CONTEXT_CHAT_LOCATION, CONTEXT_IN_CHAT_INPUT } from '../../common/chatContextKeys.js';\nimport { IChatEditingService } from '../../common/chatEditingService.js';\nimport { IChatRequestVariableEntry } from '../../common/chatModel.js';\nimport { ChatRequestAgentPart } from '../../common/chatParserTypes.js';\nimport { IChatVariableData, IChatVariablesService } from '../../common/chatVariables.js';\nimport { ILanguageModelToolsService } from '../../common/languageModelToolsService.js';\nimport { imageToHash, isImage } from '../chatPasteProviders.js';\nimport { IChatWidget, IChatWidgetService, IQuickChatService, showChatView } from '../chat.js';\nimport { isQuickChat } from '../chatWidget.js';\nimport { CHAT_CATEGORY } from './chatActions.js';\nimport { SearchView } from '../../../search/browser/searchView.js';\n\nexport function registerChatContextActions() {\n\tregisterAction2(AttachContextAction);\n\tregisterAction2(AttachFileAction);\n\tregisterAction2(AttachSelectionAction);\n}\n\n/**\n * We fill the quickpick with these types, and enable some quick access providers\n */\ntype IAttachmentQuickPickItem = ICommandVariableQuickPickItem | IQuickAccessQuickPickItem | IToolQuickPickItem | IImageQuickPickItem | IVariableQuickPickItem | IOpenEditorsQuickPickItem | ISearchResultsQuickPickItem;\n\n/**\n * These are the types that we can get out of the quick pick\n */\ntype IChatContextQuickPickItem = IAttachmentQuickPickItem | IGotoSymbolQuickPickItem | ISymbolQuickPickItem | IQuickPickItemWithResource;\n\nfunction isIGotoSymbolQuickPickItem(obj: unknown): obj is IGotoSymbolQuickPickItem {\n\treturn (\n\t\ttypeof obj === 'object'\n\t\t&& typeof (obj as IGotoSymbolQuickPickItem).symbolName === 'string'\n\t\t&& !!(obj as IGotoSymbolQuickPickItem).uri\n\t\t&& !!(obj as IGotoSymbolQuickPickItem).range);\n}\n\nfunction isISymbolQuickPickItem(obj: unknown): obj is ISymbolQuickPickItem {\n\treturn (\n\t\ttypeof obj === 'object'\n\t\t&& typeof (obj as ISymbolQuickPickItem).symbol === 'object'\n\t\t&& !!(obj as ISymbolQuickPickItem).symbol);\n}\n\nfunction isIQuickPickItemWithResource(obj: unknown): obj is IQuickPickItemWithResource {\n\treturn (\n\t\ttypeof obj === 'object'\n\t\t&& typeof (obj as IQuickPickItemWithResource).resource === 'object'\n\t\t&& URI.isUri((obj as IQuickPickItemWithResource).resource));\n}\n\nfunction isIOpenEditorsQuickPickItem(obj: unknown): obj is IOpenEditorsQuickPickItem {\n\treturn (\n\t\ttypeof obj === 'object'\n\t\t&& (obj as IOpenEditorsQuickPickItem).id === 'open-editors');\n}\n\nfunction isISearchResultsQuickPickItem(obj: unknown): obj is ISearchResultsQuickPickItem {\n\treturn (\n\t\ttypeof obj === 'object'\n\t\t&& (obj as ISearchResultsQuickPickItem).kind === 'search-results');\n}\n\ninterface IImageQuickPickItem extends IQuickPickItem {\n\tkind: 'image';\n\tid: string;\n}\n\ninterface ICommandVariableQuickPickItem extends IQuickPickItem {\n\tkind: 'command';\n\tid: string;\n\tcommand: Command;\n\tname?: string;\n\tvalue: unknown;\n\tisDynamic: true;\n\n\ticon?: ThemeIcon;\n}\n\ninterface IToolQuickPickItem extends IQuickPickItem {\n\tkind: 'tool';\n\tid: string;\n\tname?: string;\n\ticon?: ThemeIcon;\n}\n\ninterface IVariableQuickPickItem extends IQuickPickItem {\n\tkind: 'variable';\n\tvariable: IChatVariableData;\n}\n\ninterface IQuickAccessQuickPickItem extends IQuickPickItem {\n\tkind: 'quickaccess';\n\tid: string;\n\tprefix: string;\n}\n\ninterface IOpenEditorsQuickPickItem extends IQuickPickItem {\n\tkind: 'open-editors';\n\tid: 'open-editors';\n\ticon?: ThemeIcon;\n}\n\ninterface ISearchResultsQuickPickItem extends IQuickPickItem {\n\tkind: 'search-results';\n\tid: string;\n\ticon?: ThemeIcon;\n}\n\nclass AttachFileAction extends Action2 {\n\n\tstatic readonly ID = 'workbench.action.chat.attachFile';\n\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: AttachFileAction.ID,\n\t\t\ttitle: localize2('workbench.action.chat.attachFile.label', \"Add File to Chat\"),\n\t\t\tcategory: CHAT_CATEGORY,\n\t\t\tf1: false,\n\t\t\tprecondition: ActiveEditorContext.isEqualTo('workbench.editors.files.textFileEditor'),\n\t\t\tmenu: {\n\t\t\t\tid: MenuId.ChatCommandCenter,\n\t\t\t\tgroup: 'a_chat',\n\t\t\t\torder: 10,\n\t\t\t}\n\t\t});\n\t}\n\n\toverride async run(accessor: ServicesAccessor, ...args: any[]): Promise<void> {\n\t\tconst variablesService = accessor.get(IChatVariablesService);\n\t\tconst textEditorService = accessor.get(IEditorService);\n\n\t\tconst activeUri = textEditorService.activeEditor?.resource;\n\t\tif (textEditorService.activeTextEditorControl?.getEditorType() === EditorType.ICodeEditor && activeUri && [Schemas.file, Schemas.vscodeRemote, Schemas.untitled].includes(activeUri.scheme)) {\n\t\t\t(await showChatView(accessor.get(IViewsService)))?.focusInput();\n\t\t\tvariablesService.attachContext('file', activeUri, ChatAgentLocation.Panel);\n\t\t}\n\t}\n}\n\nclass AttachSelectionAction extends Action2 {\n\n\tstatic readonly ID = 'workbench.action.chat.attachSelection';\n\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: AttachSelectionAction.ID,\n\t\t\ttitle: localize2('workbench.action.chat.attachSelection.label', \"Add Selection to Chat\"),\n\t\t\tcategory: CHAT_CATEGORY,\n\t\t\tf1: false,\n\t\t\tprecondition: ActiveEditorContext.isEqualTo('workbench.editors.files.textFileEditor'),\n\t\t\tmenu: {\n\t\t\t\tid: MenuId.ChatCommandCenter,\n\t\t\t\tgroup: 'a_chat',\n\t\t\t\torder: 11,\n\t\t\t}\n\t\t});\n\t}\n\n\toverride async run(accessor: ServicesAccessor, ...args: any[]): Promise<void> {\n\t\tconst variablesService = accessor.get(IChatVariablesService);\n\t\tconst textEditorService = accessor.get(IEditorService);\n\n\t\tconst activeEditor = textEditorService.activeTextEditorControl;\n\t\tconst activeUri = textEditorService.activeEditor?.resource;\n\t\tif (textEditorService.activeTextEditorControl?.getEditorType() === EditorType.ICodeEditor && activeUri && [Schemas.file, Schemas.vscodeRemote, Schemas.untitled].includes(activeUri.scheme)) {\n\t\t\tconst selection = activeEditor?.getSelection();\n\t\t\tif (selection) {\n\t\t\t\t(await showChatView(accessor.get(IViewsService)))?.focusInput();\n\t\t\t\tvariablesService.attachContext('file', { uri: activeUri, range: selection }, ChatAgentLocation.Panel);\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport class AttachContextAction extends Action2 {\n\n\tstatic readonly ID = 'workbench.action.chat.attachContext';\n\n\t// used to enable/disable the keybinding and defined menu containment\n\tprivate static _cdt = ContextKeyExpr.or(\n\t\tContextKeyExpr.and(CONTEXT_CHAT_LOCATION.isEqualTo(ChatAgentLocation.Panel)),\n\t\tContextKeyExpr.and(CONTEXT_CHAT_LOCATION.isEqualTo(ChatAgentLocation.Editor), ContextKeyExpr.equals('config.chat.experimental.variables.editor', true)),\n\t\tContextKeyExpr.and(CONTEXT_CHAT_LOCATION.isEqualTo(ChatAgentLocation.Notebook), ContextKeyExpr.equals('config.chat.experimental.variables.notebook', true)),\n\t\tContextKeyExpr.and(CONTEXT_CHAT_LOCATION.isEqualTo(ChatAgentLocation.Terminal), ContextKeyExpr.equals('config.chat.experimental.variables.terminal', true)),\n\t);\n\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: AttachContextAction.ID,\n\t\t\ttitle: localize2('workbench.action.chat.attachContext.label', \"Attach Context\"),\n\t\t\ticon: Codicon.attach,\n\t\t\tcategory: CHAT_CATEGORY,\n\t\t\tprecondition: ContextKeyExpr.or(AttachContextAction._cdt, ContextKeyExpr.and(CONTEXT_CHAT_LOCATION.isEqualTo(ChatAgentLocation.EditingSession))),\n\t\t\tkeybinding: {\n\t\t\t\twhen: CONTEXT_IN_CHAT_INPUT,\n\t\t\t\tprimary: KeyMod.CtrlCmd | KeyCode.Slash,\n\t\t\t\tweight: KeybindingWeight.EditorContrib\n\t\t\t},\n\t\t\tmenu: [\n\t\t\t\t{\n\t\t\t\t\twhen: ContextKeyExpr.or(ContextKeyExpr.and(CONTEXT_CHAT_LOCATION.isEqualTo(ChatAgentLocation.EditingSession)), ContextKeyExpr.and(ContextKeyExpr.or(CONTEXT_CHAT_LOCATION.isEqualTo(ChatAgentLocation.Panel), CONTEXT_CHAT_LOCATION.isEqualTo(ChatAgentLocation.EditingSession)), AttachContextAction._cdt)),\n\t\t\t\t\tid: MenuId.ChatInput,\n\t\t\t\t\tgroup: 'navigation',\n\t\t\t\t\torder: 2\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\twhen: ContextKeyExpr.and(CONTEXT_CHAT_LOCATION.isEqualTo(ChatAgentLocation.Panel).negate(), AttachContextAction._cdt),\n\t\t\t\t\tid: MenuId.ChatExecute,\n\t\t\t\t\tgroup: 'navigation',\n\t\t\t\t\torder: 1\n\t\t\t\t},\n\t\t\t]\n\t\t});\n\t}\n\n\tprivate _getFileContextId(item: { resource: URI } | { uri: URI; range: IRange }) {\n\t\tif ('resource' in item) {\n\t\t\treturn item.resource.toString();\n\t\t}\n\n\t\treturn item.uri.toString() + (item.range.startLineNumber !== item.range.endLineNumber ?\n\t\t\t`:${item.range.startLineNumber}-${item.range.endLineNumber}` :\n\t\t\t`:${item.range.startLineNumber}`);\n\t}\n\n\tprivate async _attachContext(widget: IChatWidget, commandService: ICommandService, clipboardService: IClipboardService, editorService: IEditorService, labelService: ILabelService, viewsService: IViewsService, chatEditingService: IChatEditingService | undefined, ...picks: IChatContextQuickPickItem[]) {\n\t\tconst toAttach: IChatRequestVariableEntry[] = [];\n\t\tfor (const pick of picks) {\n\t\t\tif (isISymbolQuickPickItem(pick) && pick.symbol) {\n\t\t\t\t// Workspace symbol\n\t\t\t\ttoAttach.push({\n\t\t\t\t\tid: this._getFileContextId(pick.symbol.location),\n\t\t\t\t\tvalue: pick.symbol.location,\n\t\t\t\t\tfullName: pick.label,\n\t\t\t\t\tname: pick.symbol.name,\n\t\t\t\t\tisDynamic: true\n\t\t\t\t});\n\t\t\t} else if (isIQuickPickItemWithResource(pick) && pick.resource) {\n\t\t\t\tif (/\\.(png|jpg|jpeg|bmp|gif|tiff)$/i.test(pick.resource.path)) {\n\t\t\t\t\t// checks if the file is an image\n\t\t\t\t\ttoAttach.push({\n\t\t\t\t\t\tid: pick.resource.toString(),\n\t\t\t\t\t\tname: pick.label,\n\t\t\t\t\t\tfullName: pick.label,\n\t\t\t\t\t\tvalue: pick.resource,\n\t\t\t\t\t\tisDynamic: true,\n\t\t\t\t\t\tisImage: true\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\t// file attachment\n\t\t\t\t\ttoAttach.push({\n\t\t\t\t\t\tid: this._getFileContextId({ resource: pick.resource }),\n\t\t\t\t\t\tvalue: pick.resource,\n\t\t\t\t\t\tname: pick.label,\n\t\t\t\t\t\tisFile: true,\n\t\t\t\t\t\tisDynamic: true,\n\t\t\t\t\t});\n\t\t\t\t\tchatEditingService?.addFileToWorkingSet(pick.resource);\n\t\t\t\t}\n\t\t\t} else if (isIGotoSymbolQuickPickItem(pick) && pick.uri && pick.range) {\n\t\t\t\ttoAttach.push({\n\t\t\t\t\trange: undefined,\n\t\t\t\t\tid: this._getFileContextId({ uri: pick.uri, range: pick.range.decoration }),\n\t\t\t\t\tvalue: { uri: pick.uri, range: pick.range.decoration },\n\t\t\t\t\tfullName: pick.label,\n\t\t\t\t\tname: pick.symbolName!,\n\t\t\t\t\tisDynamic: true\n\t\t\t\t});\n\t\t\t} else if (isIOpenEditorsQuickPickItem(pick)) {\n\t\t\t\tfor (const editor of editorService.editors) {\n\t\t\t\t\tif (editor.resource) {\n\t\t\t\t\t\ttoAttach.push({\n\t\t\t\t\t\t\tid: this._getFileContextId({ resource: editor.resource }),\n\t\t\t\t\t\t\tvalue: editor.resource,\n\t\t\t\t\t\t\tname: labelService.getUriBasenameLabel(editor.resource),\n\t\t\t\t\t\t\tisFile: true,\n\t\t\t\t\t\t\tisDynamic: true\n\t\t\t\t\t\t});\n\t\t\t\t\t\tchatEditingService?.addFileToWorkingSet(editor.resource);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (isISearchResultsQuickPickItem(pick)) {\n\t\t\t\tconst searchView = viewsService.getViewWithId(SEARCH_VIEW_ID) as SearchView;\n\t\t\t\tfor (const result of searchView.model.searchResult.matches()) {\n\t\t\t\t\ttoAttach.push({\n\t\t\t\t\t\tid: this._getFileContextId({ resource: result.resource }),\n\t\t\t\t\t\tvalue: result.resource,\n\t\t\t\t\t\tname: labelService.getUriBasenameLabel(result.resource),\n\t\t\t\t\t\tisFile: true,\n\t\t\t\t\t\tisDynamic: true\n\t\t\t\t\t});\n\t\t\t\t\tchatEditingService?.addFileToWorkingSet(result.resource);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Anything else is an attachment\n\t\t\t\tconst attachmentPick = pick as IAttachmentQuickPickItem;\n\t\t\t\tif (attachmentPick.kind === 'command') {\n\t\t\t\t\t// Dynamic variable with a followup command\n\t\t\t\t\tconst selection = await commandService.executeCommand(attachmentPick.command.id, ...(attachmentPick.command.arguments ?? []));\n\t\t\t\t\tif (!selection) {\n\t\t\t\t\t\t// User made no selection, skip this variable\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\ttoAttach.push({\n\t\t\t\t\t\t...attachmentPick,\n\t\t\t\t\t\tisDynamic: attachmentPick.isDynamic,\n\t\t\t\t\t\tvalue: attachmentPick.value,\n\t\t\t\t\t\tname: `${typeof attachmentPick.value === 'string' && attachmentPick.value.startsWith('#') ? attachmentPick.value.slice(1) : ''}${selection}`,\n\t\t\t\t\t\t// Apply the original icon with the new name\n\t\t\t\t\t\tfullName: selection\n\t\t\t\t\t});\n\t\t\t\t} else if (attachmentPick.kind === 'tool') {\n\t\t\t\t\ttoAttach.push({\n\t\t\t\t\t\tid: attachmentPick.id,\n\t\t\t\t\t\tname: attachmentPick.label,\n\t\t\t\t\t\tfullName: attachmentPick.label,\n\t\t\t\t\t\tvalue: undefined,\n\t\t\t\t\t\ticon: attachmentPick.icon,\n\t\t\t\t\t\tisTool: true\n\t\t\t\t\t});\n\t\t\t\t} else if (attachmentPick.kind === 'image') {\n\t\t\t\t\tconst fileBuffer = await clipboardService.readImage();\n\t\t\t\t\ttoAttach.push({\n\t\t\t\t\t\tid: await imageToHash(fileBuffer),\n\t\t\t\t\t\tname: localize('pastedImage', 'Pasted Image'),\n\t\t\t\t\t\tfullName: localize('pastedImage', 'Pasted Image'),\n\t\t\t\t\t\tvalue: fileBuffer,\n\t\t\t\t\t\tisDynamic: true,\n\t\t\t\t\t\tisImage: true\n\t\t\t\t\t});\n\t\t\t\t} else if (attachmentPick.kind === 'variable') {\n\t\t\t\t\t// All other dynamic variables and static variables\n\t\t\t\t\ttoAttach.push({\n\t\t\t\t\t\trange: undefined,\n\t\t\t\t\t\tid: pick.id ?? '',\n\t\t\t\t\t\tvalue: undefined,\n\t\t\t\t\t\tfullName: pick.label,\n\t\t\t\t\t\tname: attachmentPick.variable.name,\n\t\t\t\t\t\ticon: attachmentPick.variable.icon\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\twidget.attachmentModel.addContext(...toAttach);\n\t}\n\n\toverride async run(accessor: ServicesAccessor, ...args: any[]): Promise<void> {\n\t\tconst quickInputService = accessor.get(IQuickInputService);\n\t\tconst chatAgentService = accessor.get(IChatAgentService);\n\t\tconst chatVariablesService = accessor.get(IChatVariablesService);\n\t\tconst commandService = accessor.get(ICommandService);\n\t\tconst widgetService = accessor.get(IChatWidgetService);\n\t\tconst languageModelToolsService = accessor.get(ILanguageModelToolsService);\n\t\tconst quickChatService = accessor.get(IQuickChatService);\n\t\tconst clipboardService = accessor.get(IClipboardService);\n\t\tconst configurationService = accessor.get(IConfigurationService);\n\t\tconst editorService = accessor.get(IEditorService);\n\t\tconst labelService = accessor.get(ILabelService);\n\t\tconst contextKeyService = accessor.get(IContextKeyService);\n\t\tconst viewsService = accessor.get(IViewsService);\n\n\t\tconst context: { widget?: IChatWidget; showFilesOnly?: boolean; placeholder?: string } | undefined = args[0];\n\t\tconst widget = context?.widget ?? widgetService.lastFocusedWidget;\n\t\tif (!widget) {\n\t\t\treturn;\n\t\t}\n\t\tconst chatEditingService = widget.location === ChatAgentLocation.EditingSession ? accessor.get(IChatEditingService) : undefined;\n\n\t\tconst usedAgent = widget.parsedInput.parts.find(p => p instanceof ChatRequestAgentPart);\n\t\tconst slowSupported = usedAgent ? usedAgent.agent.metadata.supportsSlowVariables : true;\n\t\tconst quickPickItems: IAttachmentQuickPickItem[] = [];\n\t\tif (!context || !context.showFilesOnly) {\n\t\t\tfor (const variable of chatVariablesService.getVariables(widget.location)) {\n\t\t\t\tif (variable.fullName && (!variable.isSlow || slowSupported)) {\n\t\t\t\t\tquickPickItems.push({\n\t\t\t\t\t\tkind: 'variable',\n\t\t\t\t\t\tvariable,\n\t\t\t\t\t\tlabel: variable.fullName,\n\t\t\t\t\t\tid: variable.id,\n\t\t\t\t\t\ticonClass: variable.icon ? ThemeIcon.asClassName(variable.icon) : undefined,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (configurationService.getValue<boolean>('chat.experimental.imageAttachments')) {\n\t\t\t\tconst imageData = await clipboardService.readImage();\n\t\t\t\tif (isImage(imageData)) {\n\t\t\t\t\tquickPickItems.push({\n\t\t\t\t\t\tkind: 'image',\n\t\t\t\t\t\tid: await imageToHash(imageData),\n\t\t\t\t\t\tlabel: localize('imageFromClipboard', 'Image from Clipboard'),\n\t\t\t\t\t\ticonClass: ThemeIcon.asClassName(Codicon.fileMedia),\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (widget.viewModel?.sessionId) {\n\t\t\t\tconst agentPart = widget.parsedInput.parts.find((part): part is ChatRequestAgentPart => part instanceof ChatRequestAgentPart);\n\t\t\t\tif (agentPart) {\n\t\t\t\t\tconst completions = await chatAgentService.getAgentCompletionItems(agentPart.agent.id, '', CancellationToken.None);\n\t\t\t\t\tfor (const variable of completions) {\n\t\t\t\t\t\tif (variable.fullName && variable.command) {\n\t\t\t\t\t\t\tquickPickItems.push({\n\t\t\t\t\t\t\t\tkind: 'command',\n\t\t\t\t\t\t\t\tlabel: variable.fullName,\n\t\t\t\t\t\t\t\tid: variable.id,\n\t\t\t\t\t\t\t\tcommand: variable.command,\n\t\t\t\t\t\t\t\ticon: variable.icon,\n\t\t\t\t\t\t\t\ticonClass: variable.icon ? ThemeIcon.asClassName(variable.icon) : undefined,\n\t\t\t\t\t\t\t\tvalue: variable.value,\n\t\t\t\t\t\t\t\tisDynamic: true,\n\t\t\t\t\t\t\t\tname: variable.name\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// Currently there's nothing that falls into this category\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!usedAgent || usedAgent.agent.supportsToolReferences) {\n\t\t\t\tfor (const tool of languageModelToolsService.getTools()) {\n\t\t\t\t\tif (tool.canBeInvokedManually) {\n\t\t\t\t\t\tconst item: IToolQuickPickItem = {\n\t\t\t\t\t\t\tkind: 'tool',\n\t\t\t\t\t\t\tlabel: tool.displayName ?? tool.name ?? '',\n\t\t\t\t\t\t\tid: tool.id,\n\t\t\t\t\t\t\ticon: ThemeIcon.isThemeIcon(tool.icon) ? tool.icon : undefined // TODO need to support icon path?\n\t\t\t\t\t\t};\n\t\t\t\t\t\tif (ThemeIcon.isThemeIcon(tool.icon)) {\n\t\t\t\t\t\t\titem.iconClass = ThemeIcon.asClassName(tool.icon);\n\t\t\t\t\t\t} else if (tool.icon) {\n\t\t\t\t\t\t\titem.iconPath = tool.icon;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tquickPickItems.push(item);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tquickPickItems.push({\n\t\t\t\tkind: 'quickaccess',\n\t\t\t\tlabel: localize('chatContext.symbol', 'Symbol...'),\n\t\t\t\ticonClass: ThemeIcon.asClassName(Codicon.symbolField),\n\t\t\t\tprefix: SymbolsQuickAccessProvider.PREFIX,\n\t\t\t\tid: 'symbol'\n\t\t\t});\n\n\t\t\tif (widget.location === ChatAgentLocation.Notebook) {\n\t\t\t\tquickPickItems.push({\n\t\t\t\t\tkind: 'command',\n\t\t\t\t\tid: 'chatContext.notebook.kernelVariable',\n\t\t\t\t\tisDynamic: true,\n\t\t\t\t\ticon: ThemeIcon.fromId(Codicon.serverEnvironment.id),\n\t\t\t\t\ticonClass: ThemeIcon.asClassName(Codicon.serverEnvironment),\n\t\t\t\t\tvalue: 'kernelVariable',\n\t\t\t\t\tlabel: localize('chatContext.notebook.kernelVariable', 'Kernel Variable...'),\n\t\t\t\t\tcommand: {\n\t\t\t\t\t\tid: 'notebook.chat.selectAndInsertKernelVariable',\n\t\t\t\t\t\ttitle: localize('chatContext.notebook.selectkernelVariable', 'Select and Insert Kernel Variable'),\n\t\t\t\t\t\targuments: [{ widget, range: undefined }]\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t} else if (context.showFilesOnly) {\n\t\t\tif (editorService.count > 0) {\n\t\t\t\tquickPickItems.push({\n\t\t\t\t\tkind: 'open-editors',\n\t\t\t\t\tid: 'open-editors',\n\t\t\t\t\tlabel: localize('chatContext.editors', 'Open Editors'),\n\t\t\t\t\ticonClass: ThemeIcon.asClassName(Codicon.files),\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (SearchContext.HasSearchResults.getValue(contextKeyService)) {\n\t\t\t\tquickPickItems.push({\n\t\t\t\t\tkind: 'search-results',\n\t\t\t\t\tid: 'search-results',\n\t\t\t\t\tlabel: localize('chatContext.searchResults', 'Search Results'),\n\t\t\t\t\ticonClass: ThemeIcon.asClassName(Codicon.search),\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tfunction extractTextFromIconLabel(label: string | undefined): string {\n\t\t\tif (!label) {\n\t\t\t\treturn '';\n\t\t\t}\n\t\t\tconst match = label.match(/\\$\\([^\\)]+\\)\\s*(.+)/);\n\t\t\treturn match ? match[1] : label;\n\t\t}\n\n\t\tthis._show(quickInputService, commandService, widget, quickChatService, quickPickItems.sort(function (a, b) {\n\n\t\t\tconst first = extractTextFromIconLabel(a.label).toUpperCase();\n\t\t\tconst second = extractTextFromIconLabel(b.label).toUpperCase();\n\n\t\t\treturn compare(first, second);\n\t\t}), clipboardService, editorService, labelService, viewsService, chatEditingService, '', context?.placeholder);\n\t}\n\n\tprivate _show(quickInputService: IQuickInputService, commandService: ICommandService, widget: IChatWidget, quickChatService: IQuickChatService, quickPickItems: (IChatContextQuickPickItem | QuickPickItem)[] | undefined, clipboardService: IClipboardService, editorService: IEditorService, labelService: ILabelService, viewsService: IViewsService, chatEditingService: IChatEditingService | undefined, query: string = '', placeholder?: string) {\n\t\tconst providerOptions: AnythingQuickAccessProviderRunOptions = {\n\t\t\thandleAccept: (item: IChatContextQuickPickItem) => {\n\t\t\t\tif ('prefix' in item) {\n\t\t\t\t\tthis._show(quickInputService, commandService, widget, quickChatService, quickPickItems, clipboardService, editorService, labelService, viewsService, chatEditingService, item.prefix, placeholder);\n\t\t\t\t} else {\n\t\t\t\t\tif (!clipboardService) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tthis._attachContext(widget, commandService, clipboardService, editorService, labelService, viewsService, chatEditingService, item);\n\t\t\t\t\tif (isQuickChat(widget)) {\n\t\t\t\t\t\tquickChatService.open();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tadditionPicks: quickPickItems,\n\t\t\tfilter: (item: IChatContextQuickPickItem | IQuickPickSeparator) => {\n\t\t\t\t// Avoid attaching the same context twice\n\t\t\t\tconst attachedContext = widget.attachmentModel.getAttachmentIDs();\n\n\t\t\t\tif (isIOpenEditorsQuickPickItem(item)) {\n\t\t\t\t\tfor (const editor of editorService.editors) {\n\t\t\t\t\t\t// There is an open editor that hasn't yet been attached to the chat\n\t\t\t\t\t\tif (editor.resource && !attachedContext.has(this._getFileContextId({ resource: editor.resource }))) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif ('kind' in item && item.kind === 'image') {\n\t\t\t\t\treturn !attachedContext.has(item.id);\n\t\t\t\t}\n\n\t\t\t\tif ('symbol' in item && item.symbol) {\n\t\t\t\t\treturn !attachedContext.has(this._getFileContextId(item.symbol.location));\n\t\t\t\t}\n\n\t\t\t\tif (item && typeof item === 'object' && 'resource' in item && URI.isUri(item.resource)) {\n\t\t\t\t\treturn [Schemas.file, Schemas.vscodeRemote].includes(item.resource.scheme)\n\t\t\t\t\t\t&& !attachedContext.has(this._getFileContextId({ resource: item.resource })); // Hack because Typescript doesn't narrow this type correctly\n\t\t\t\t}\n\n\t\t\t\tif (item && typeof item === 'object' && 'uri' in item && item.uri && item.range) {\n\t\t\t\t\treturn !attachedContext.has(this._getFileContextId({ uri: item.uri, range: item.range.decoration }));\n\t\t\t\t}\n\n\t\t\t\tif (!('command' in item) && item.id) {\n\t\t\t\t\treturn !attachedContext.has(item.id);\n\t\t\t\t}\n\n\t\t\t\t// Don't filter out dynamic variables which show secondary data (temporary)\n\t\t\t\treturn true;\n\t\t\t}\n\t\t};\n\t\tquickInputService.quickAccess.show(query, {\n\t\t\tenabledProviderPrefixes: [\n\t\t\t\tAnythingQuickAccessProvider.PREFIX,\n\t\t\t\tSymbolsQuickAccessProvider.PREFIX,\n\t\t\t\tAbstractGotoSymbolQuickAccessProvider.PREFIX\n\t\t\t],\n\t\t\tplaceholder: placeholder ?? localize('chatContext.attach.placeholder', 'Search attachments'),\n\t\t\tproviderOptions,\n\t\t});\n\t}\n}\n"],
  "mappings": ";;AAKA,SAAS,yBAAyB;AAClC,SAAS,eAAe;AACxB,SAAS,SAAS,cAAc;AAChC,SAAS,eAAe;AACxB,SAAS,eAAe;AACxB,SAAS,iBAAiB;AAC1B,SAAS,WAAW;AACpB,SAAS,wBAAwB;AACjC,SAAS,cAAc;AACvB,SAAS,kBAAkB;AAC3B,SAAS,eAAe;AACxB,SAAS,uCAAuC,gCAAgC;AAChF,SAAS,UAAU,iBAAiB;AACpC,SAAS,SAAS,QAAQ,uBAAuB;AACjD,SAAS,yBAAyB;AAClC,SAAS,uBAAuB;AAChC,SAAS,6BAA6B;AACtC,SAAS,gBAAgB,0BAA0B;AACnD,SAAS,wBAAwB;AACjC,SAAS,qBAAqB;AAC9B,SAAS,6CAA6C;AACtD,SAAS,oBAAoB,gBAAgB,4BAA4B,qBAAqB,qBAAqB;AACnH,SAAS,2BAA2B;AACpC,SAAS,sBAAsB;AAC/B,SAAS,qBAAqB;AAC9B,SAAS,mCAAmC;AAC5C,SAAS,sBAAsB,kCAAkC;AACjE,SAAS,qBAAqB;AAC9B,SAAS,WAAW,sBAAsB;AAC1C,SAAS,mBAAmB,yBAAyB;AACrD,SAAS,uBAAuB,6BAA6B;AAC7D,SAAS,2BAA2B;AACpC,SAAS,iCAAiC;AAC1C,SAAS,4BAA4B;AACrC,SAAS,mBAAmB,6BAA6B;AACzD,SAAS,kCAAkC;AAC3C,SAAS,aAAa,eAAe;AACrC,SAAS,aAAa,oBAAoB,mBAAmB,oBAAoB;AACjF,SAAS,mBAAmB;AAC5B,SAAS,qBAAqB;AAC9B,SAAS,kBAAkB;AAEpB,SAAS,6BAA6B;AAC5C,kBAAgB,mBAAmB;AACnC,kBAAgB,gBAAgB;AAChC,kBAAgB,qBAAqB;AACtC;AAJgB;AAgBhB,SAAS,2BAA2B,KAA+C;AAClF,SACC,OAAO,QAAQ,YACZ,OAAQ,IAAiC,eAAe,YACxD,CAAC,CAAE,IAAiC,OACpC,CAAC,CAAE,IAAiC;AACzC;AANS;AAQT,SAAS,uBAAuB,KAA2C;AAC1E,SACC,OAAO,QAAQ,YACZ,OAAQ,IAA6B,WAAW,YAChD,CAAC,CAAE,IAA6B;AACrC;AALS;AAOT,SAAS,6BAA6B,KAAiD;AACtF,SACC,OAAO,QAAQ,YACZ,OAAQ,IAAmC,aAAa,YACxD,IAAI,MAAO,IAAmC,QAAQ;AAC3D;AALS;AAOT,SAAS,4BAA4B,KAAgD;AACpF,SACC,OAAO,QAAQ,YACX,IAAkC,OAAO;AAC/C;AAJS;AAMT,SAAS,8BAA8B,KAAkD;AACxF,SACC,OAAO,QAAQ,YACX,IAAoC,SAAS;AACnD;AAJS;AAoDT,MAAM,yBAAyB,QAAQ;AAAA,EA/IvC,OA+IuC;AAAA;AAAA;AAAA,EAEtC,OAAgB,KAAK;AAAA,EAErB,cAAc;AACb,UAAM;AAAA,MACL,IAAI,iBAAiB;AAAA,MACrB,OAAO,UAAU,0CAA0C,kBAAkB;AAAA,MAC7E,UAAU;AAAA,MACV,IAAI;AAAA,MACJ,cAAc,oBAAoB,UAAU,wCAAwC;AAAA,MACpF,MAAM;AAAA,QACL,IAAI,OAAO;AAAA,QACX,OAAO;AAAA,QACP,OAAO;AAAA,MACR;AAAA,IACD,CAAC;AAAA,EACF;AAAA,EAEA,MAAe,IAAI,aAA+B,MAA4B;AAC7E,UAAM,mBAAmB,SAAS,IAAI,qBAAqB;AAC3D,UAAM,oBAAoB,SAAS,IAAI,cAAc;AAErD,UAAM,YAAY,kBAAkB,cAAc;AAClD,QAAI,kBAAkB,yBAAyB,cAAc,MAAM,WAAW,eAAe,aAAa,CAAC,QAAQ,MAAM,QAAQ,cAAc,QAAQ,QAAQ,EAAE,SAAS,UAAU,MAAM,GAAG;AAC5L,OAAC,MAAM,aAAa,SAAS,IAAI,aAAa,CAAC,IAAI,WAAW;AAC9D,uBAAiB,cAAc,QAAQ,WAAW,kBAAkB,KAAK;AAAA,IAC1E;AAAA,EACD;AACD;AAEA,MAAM,8BAA8B,QAAQ;AAAA,EA9K5C,OA8K4C;AAAA;AAAA;AAAA,EAE3C,OAAgB,KAAK;AAAA,EAErB,cAAc;AACb,UAAM;AAAA,MACL,IAAI,sBAAsB;AAAA,MAC1B,OAAO,UAAU,+CAA+C,uBAAuB;AAAA,MACvF,UAAU;AAAA,MACV,IAAI;AAAA,MACJ,cAAc,oBAAoB,UAAU,wCAAwC;AAAA,MACpF,MAAM;AAAA,QACL,IAAI,OAAO;AAAA,QACX,OAAO;AAAA,QACP,OAAO;AAAA,MACR;AAAA,IACD,CAAC;AAAA,EACF;AAAA,EAEA,MAAe,IAAI,aAA+B,MAA4B;AAC7E,UAAM,mBAAmB,SAAS,IAAI,qBAAqB;AAC3D,UAAM,oBAAoB,SAAS,IAAI,cAAc;AAErD,UAAM,eAAe,kBAAkB;AACvC,UAAM,YAAY,kBAAkB,cAAc;AAClD,QAAI,kBAAkB,yBAAyB,cAAc,MAAM,WAAW,eAAe,aAAa,CAAC,QAAQ,MAAM,QAAQ,cAAc,QAAQ,QAAQ,EAAE,SAAS,UAAU,MAAM,GAAG;AAC5L,YAAM,YAAY,cAAc,aAAa;AAC7C,UAAI,WAAW;AACd,SAAC,MAAM,aAAa,SAAS,IAAI,aAAa,CAAC,IAAI,WAAW;AAC9D,yBAAiB,cAAc,QAAQ,EAAE,KAAK,WAAW,OAAO,UAAU,GAAG,kBAAkB,KAAK;AAAA,MACrG;AAAA,IACD;AAAA,EACD;AACD;AAEO,MAAM,4BAA4B,QAAQ;AAAA,EAjNjD,OAiNiD;AAAA;AAAA;AAAA,EAEhD,OAAgB,KAAK;AAAA;AAAA,EAGrB,OAAe,OAAO,eAAe;AAAA,IACpC,eAAe,IAAI,sBAAsB,UAAU,kBAAkB,KAAK,CAAC;AAAA,IAC3E,eAAe,IAAI,sBAAsB,UAAU,kBAAkB,MAAM,GAAG,eAAe,OAAO,6CAA6C,IAAI,CAAC;AAAA,IACtJ,eAAe,IAAI,sBAAsB,UAAU,kBAAkB,QAAQ,GAAG,eAAe,OAAO,+CAA+C,IAAI,CAAC;AAAA,IAC1J,eAAe,IAAI,sBAAsB,UAAU,kBAAkB,QAAQ,GAAG,eAAe,OAAO,+CAA+C,IAAI,CAAC;AAAA,EAC3J;AAAA,EAEA,cAAc;AACb,UAAM;AAAA,MACL,IAAI,oBAAoB;AAAA,MACxB,OAAO,UAAU,6CAA6C,gBAAgB;AAAA,MAC9E,MAAM,QAAQ;AAAA,MACd,UAAU;AAAA,MACV,cAAc,eAAe,GAAG,oBAAoB,MAAM,eAAe,IAAI,sBAAsB,UAAU,kBAAkB,cAAc,CAAC,CAAC;AAAA,MAC/I,YAAY;AAAA,QACX,MAAM;AAAA,QACN,SAAS,OAAO,UAAU,QAAQ;AAAA,QAClC,QAAQ,iBAAiB;AAAA,MAC1B;AAAA,MACA,MAAM;AAAA,QACL;AAAA,UACC,MAAM,eAAe,GAAG,eAAe,IAAI,sBAAsB,UAAU,kBAAkB,cAAc,CAAC,GAAG,eAAe,IAAI,eAAe,GAAG,sBAAsB,UAAU,kBAAkB,KAAK,GAAG,sBAAsB,UAAU,kBAAkB,cAAc,CAAC,GAAG,oBAAoB,IAAI,CAAC;AAAA,UAC3S,IAAI,OAAO;AAAA,UACX,OAAO;AAAA,UACP,OAAO;AAAA,QACR;AAAA,QACA;AAAA,UACC,MAAM,eAAe,IAAI,sBAAsB,UAAU,kBAAkB,KAAK,EAAE,OAAO,GAAG,oBAAoB,IAAI;AAAA,UACpH,IAAI,OAAO;AAAA,UACX,OAAO;AAAA,UACP,OAAO;AAAA,QACR;AAAA,MACD;AAAA,IACD,CAAC;AAAA,EACF;AAAA,EAEQ,kBAAkB,MAAuD;AAChF,QAAI,cAAc,MAAM;AACvB,aAAO,KAAK,SAAS,SAAS;AAAA,IAC/B;AAEA,WAAO,KAAK,IAAI,SAAS,KAAK,KAAK,MAAM,oBAAoB,KAAK,MAAM,gBACvE,IAAI,KAAK,MAAM,eAAe,IAAI,KAAK,MAAM,aAAa,KAC1D,IAAI,KAAK,MAAM,eAAe;AAAA,EAChC;AAAA,EAEA,MAAc,eAAe,QAAqB,gBAAiC,kBAAqC,eAA+B,cAA6B,cAA6B,uBAAwD,OAAoC;AAC5S,UAAM,WAAwC,CAAC;AAC/C,eAAW,QAAQ,OAAO;AACzB,UAAI,uBAAuB,IAAI,KAAK,KAAK,QAAQ;AAEhD,iBAAS,KAAK;AAAA,UACb,IAAI,KAAK,kBAAkB,KAAK,OAAO,QAAQ;AAAA,UAC/C,OAAO,KAAK,OAAO;AAAA,UACnB,UAAU,KAAK;AAAA,UACf,MAAM,KAAK,OAAO;AAAA,UAClB,WAAW;AAAA,QACZ,CAAC;AAAA,MACF,WAAW,6BAA6B,IAAI,KAAK,KAAK,UAAU;AAC/D,YAAI,kCAAkC,KAAK,KAAK,SAAS,IAAI,GAAG;AAE/D,mBAAS,KAAK;AAAA,YACb,IAAI,KAAK,SAAS,SAAS;AAAA,YAC3B,MAAM,KAAK;AAAA,YACX,UAAU,KAAK;AAAA,YACf,OAAO,KAAK;AAAA,YACZ,WAAW;AAAA,YACX,SAAS;AAAA,UACV,CAAC;AAAA,QACF,OAAO;AAEN,mBAAS,KAAK;AAAA,YACb,IAAI,KAAK,kBAAkB,EAAE,UAAU,KAAK,SAAS,CAAC;AAAA,YACtD,OAAO,KAAK;AAAA,YACZ,MAAM,KAAK;AAAA,YACX,QAAQ;AAAA,YACR,WAAW;AAAA,UACZ,CAAC;AACD,8BAAoB,oBAAoB,KAAK,QAAQ;AAAA,QACtD;AAAA,MACD,WAAW,2BAA2B,IAAI,KAAK,KAAK,OAAO,KAAK,OAAO;AACtE,iBAAS,KAAK;AAAA,UACb,OAAO;AAAA,UACP,IAAI,KAAK,kBAAkB,EAAE,KAAK,KAAK,KAAK,OAAO,KAAK,MAAM,WAAW,CAAC;AAAA,UAC1E,OAAO,EAAE,KAAK,KAAK,KAAK,OAAO,KAAK,MAAM,WAAW;AAAA,UACrD,UAAU,KAAK;AAAA,UACf,MAAM,KAAK;AAAA,UACX,WAAW;AAAA,QACZ,CAAC;AAAA,MACF,WAAW,4BAA4B,IAAI,GAAG;AAC7C,mBAAW,UAAU,cAAc,SAAS;AAC3C,cAAI,OAAO,UAAU;AACpB,qBAAS,KAAK;AAAA,cACb,IAAI,KAAK,kBAAkB,EAAE,UAAU,OAAO,SAAS,CAAC;AAAA,cACxD,OAAO,OAAO;AAAA,cACd,MAAM,aAAa,oBAAoB,OAAO,QAAQ;AAAA,cACtD,QAAQ;AAAA,cACR,WAAW;AAAA,YACZ,CAAC;AACD,gCAAoB,oBAAoB,OAAO,QAAQ;AAAA,UACxD;AAAA,QACD;AAAA,MACD,WAAW,8BAA8B,IAAI,GAAG;AAC/C,cAAM,aAAa,aAAa,cAAc,cAAc;AAC5D,mBAAW,UAAU,WAAW,MAAM,aAAa,QAAQ,GAAG;AAC7D,mBAAS,KAAK;AAAA,YACb,IAAI,KAAK,kBAAkB,EAAE,UAAU,OAAO,SAAS,CAAC;AAAA,YACxD,OAAO,OAAO;AAAA,YACd,MAAM,aAAa,oBAAoB,OAAO,QAAQ;AAAA,YACtD,QAAQ;AAAA,YACR,WAAW;AAAA,UACZ,CAAC;AACD,8BAAoB,oBAAoB,OAAO,QAAQ;AAAA,QACxD;AAAA,MACD,OAAO;AAEN,cAAM,iBAAiB;AACvB,YAAI,eAAe,SAAS,WAAW;AAEtC,gBAAM,YAAY,MAAM,eAAe,eAAe,eAAe,QAAQ,IAAI,GAAI,eAAe,QAAQ,aAAa,CAAC,CAAE;AAC5H,cAAI,CAAC,WAAW;AAEf;AAAA,UACD;AACA,mBAAS,KAAK;AAAA,YACb,GAAG;AAAA,YACH,WAAW,eAAe;AAAA,YAC1B,OAAO,eAAe;AAAA,YACtB,MAAM,GAAG,OAAO,eAAe,UAAU,YAAY,eAAe,MAAM,WAAW,GAAG,IAAI,eAAe,MAAM,MAAM,CAAC,IAAI,EAAE,GAAG,SAAS;AAAA;AAAA,YAE1I,UAAU;AAAA,UACX,CAAC;AAAA,QACF,WAAW,eAAe,SAAS,QAAQ;AAC1C,mBAAS,KAAK;AAAA,YACb,IAAI,eAAe;AAAA,YACnB,MAAM,eAAe;AAAA,YACrB,UAAU,eAAe;AAAA,YACzB,OAAO;AAAA,YACP,MAAM,eAAe;AAAA,YACrB,QAAQ;AAAA,UACT,CAAC;AAAA,QACF,WAAW,eAAe,SAAS,SAAS;AAC3C,gBAAM,aAAa,MAAM,iBAAiB,UAAU;AACpD,mBAAS,KAAK;AAAA,YACb,IAAI,MAAM,YAAY,UAAU;AAAA,YAChC,MAAM,SAAS,eAAe,cAAc;AAAA,YAC5C,UAAU,SAAS,eAAe,cAAc;AAAA,YAChD,OAAO;AAAA,YACP,WAAW;AAAA,YACX,SAAS;AAAA,UACV,CAAC;AAAA,QACF,WAAW,eAAe,SAAS,YAAY;AAE9C,mBAAS,KAAK;AAAA,YACb,OAAO;AAAA,YACP,IAAI,KAAK,MAAM;AAAA,YACf,OAAO;AAAA,YACP,UAAU,KAAK;AAAA,YACf,MAAM,eAAe,SAAS;AAAA,YAC9B,MAAM,eAAe,SAAS;AAAA,UAC/B,CAAC;AAAA,QACF;AAAA,MACD;AAAA,IACD;AAEA,WAAO,gBAAgB,WAAW,GAAG,QAAQ;AAAA,EAC9C;AAAA,EAEA,MAAe,IAAI,aAA+B,MAA4B;AAC7E,UAAM,oBAAoB,SAAS,IAAI,kBAAkB;AACzD,UAAM,mBAAmB,SAAS,IAAI,iBAAiB;AACvD,UAAM,uBAAuB,SAAS,IAAI,qBAAqB;AAC/D,UAAM,iBAAiB,SAAS,IAAI,eAAe;AACnD,UAAM,gBAAgB,SAAS,IAAI,kBAAkB;AACrD,UAAM,4BAA4B,SAAS,IAAI,0BAA0B;AACzE,UAAM,mBAAmB,SAAS,IAAI,iBAAiB;AACvD,UAAM,mBAAmB,SAAS,IAAI,iBAAiB;AACvD,UAAM,uBAAuB,SAAS,IAAI,qBAAqB;AAC/D,UAAM,gBAAgB,SAAS,IAAI,cAAc;AACjD,UAAM,eAAe,SAAS,IAAI,aAAa;AAC/C,UAAM,oBAAoB,SAAS,IAAI,kBAAkB;AACzD,UAAM,eAAe,SAAS,IAAI,aAAa;AAE/C,UAAM,UAA+F,KAAK,CAAC;AAC3G,UAAM,SAAS,SAAS,UAAU,cAAc;AAChD,QAAI,CAAC,QAAQ;AACZ;AAAA,IACD;AACA,UAAM,qBAAqB,OAAO,aAAa,kBAAkB,iBAAiB,SAAS,IAAI,mBAAmB,IAAI;AAEtH,UAAM,YAAY,OAAO,YAAY,MAAM,KAAK,OAAK,aAAa,oBAAoB;AACtF,UAAM,gBAAgB,YAAY,UAAU,MAAM,SAAS,wBAAwB;AACnF,UAAM,iBAA6C,CAAC;AACpD,QAAI,CAAC,WAAW,CAAC,QAAQ,eAAe;AACvC,iBAAW,YAAY,qBAAqB,aAAa,OAAO,QAAQ,GAAG;AAC1E,YAAI,SAAS,aAAa,CAAC,SAAS,UAAU,gBAAgB;AAC7D,yBAAe,KAAK;AAAA,YACnB,MAAM;AAAA,YACN;AAAA,YACA,OAAO,SAAS;AAAA,YAChB,IAAI,SAAS;AAAA,YACb,WAAW,SAAS,OAAO,UAAU,YAAY,SAAS,IAAI,IAAI;AAAA,UACnE,CAAC;AAAA,QACF;AAAA,MACD;AAEA,UAAI,qBAAqB,SAAkB,oCAAoC,GAAG;AACjF,cAAM,YAAY,MAAM,iBAAiB,UAAU;AACnD,YAAI,QAAQ,SAAS,GAAG;AACvB,yBAAe,KAAK;AAAA,YACnB,MAAM;AAAA,YACN,IAAI,MAAM,YAAY,SAAS;AAAA,YAC/B,OAAO,SAAS,sBAAsB,sBAAsB;AAAA,YAC5D,WAAW,UAAU,YAAY,QAAQ,SAAS;AAAA,UACnD,CAAC;AAAA,QACF;AAAA,MACD;AAEA,UAAI,OAAO,WAAW,WAAW;AAChC,cAAM,YAAY,OAAO,YAAY,MAAM,KAAK,CAAC,SAAuC,gBAAgB,oBAAoB;AAC5H,YAAI,WAAW;AACd,gBAAM,cAAc,MAAM,iBAAiB,wBAAwB,UAAU,MAAM,IAAI,IAAI,kBAAkB,IAAI;AACjH,qBAAW,YAAY,aAAa;AACnC,gBAAI,SAAS,YAAY,SAAS,SAAS;AAC1C,6BAAe,KAAK;AAAA,gBACnB,MAAM;AAAA,gBACN,OAAO,SAAS;AAAA,gBAChB,IAAI,SAAS;AAAA,gBACb,SAAS,SAAS;AAAA,gBAClB,MAAM,SAAS;AAAA,gBACf,WAAW,SAAS,OAAO,UAAU,YAAY,SAAS,IAAI,IAAI;AAAA,gBAClE,OAAO,SAAS;AAAA,gBAChB,WAAW;AAAA,gBACX,MAAM,SAAS;AAAA,cAChB,CAAC;AAAA,YACF,OAAO;AAAA,YAEP;AAAA,UACD;AAAA,QACD;AAAA,MACD;AAEA,UAAI,CAAC,aAAa,UAAU,MAAM,wBAAwB;AACzD,mBAAW,QAAQ,0BAA0B,SAAS,GAAG;AACxD,cAAI,KAAK,sBAAsB;AAC9B,kBAAM,OAA2B;AAAA,cAChC,MAAM;AAAA,cACN,OAAO,KAAK,eAAe,KAAK,QAAQ;AAAA,cACxC,IAAI,KAAK;AAAA,cACT,MAAM,UAAU,YAAY,KAAK,IAAI,IAAI,KAAK,OAAO;AAAA;AAAA,YACtD;AACA,gBAAI,UAAU,YAAY,KAAK,IAAI,GAAG;AACrC,mBAAK,YAAY,UAAU,YAAY,KAAK,IAAI;AAAA,YACjD,WAAW,KAAK,MAAM;AACrB,mBAAK,WAAW,KAAK;AAAA,YACtB;AAEA,2BAAe,KAAK,IAAI;AAAA,UACzB;AAAA,QACD;AAAA,MACD;AAEA,qBAAe,KAAK;AAAA,QACnB,MAAM;AAAA,QACN,OAAO,SAAS,sBAAsB,WAAW;AAAA,QACjD,WAAW,UAAU,YAAY,QAAQ,WAAW;AAAA,QACpD,QAAQ,2BAA2B;AAAA,QACnC,IAAI;AAAA,MACL,CAAC;AAED,UAAI,OAAO,aAAa,kBAAkB,UAAU;AACnD,uBAAe,KAAK;AAAA,UACnB,MAAM;AAAA,UACN,IAAI;AAAA,UACJ,WAAW;AAAA,UACX,MAAM,UAAU,OAAO,QAAQ,kBAAkB,EAAE;AAAA,UACnD,WAAW,UAAU,YAAY,QAAQ,iBAAiB;AAAA,UAC1D,OAAO;AAAA,UACP,OAAO,SAAS,uCAAuC,oBAAoB;AAAA,UAC3E,SAAS;AAAA,YACR,IAAI;AAAA,YACJ,OAAO,SAAS,6CAA6C,mCAAmC;AAAA,YAChG,WAAW,CAAC,EAAE,QAAQ,OAAO,OAAU,CAAC;AAAA,UACzC;AAAA,QACD,CAAC;AAAA,MACF;AAAA,IACD,WAAW,QAAQ,eAAe;AACjC,UAAI,cAAc,QAAQ,GAAG;AAC5B,uBAAe,KAAK;AAAA,UACnB,MAAM;AAAA,UACN,IAAI;AAAA,UACJ,OAAO,SAAS,uBAAuB,cAAc;AAAA,UACrD,WAAW,UAAU,YAAY,QAAQ,KAAK;AAAA,QAC/C,CAAC;AAAA,MACF;AACA,UAAI,cAAc,iBAAiB,SAAS,iBAAiB,GAAG;AAC/D,uBAAe,KAAK;AAAA,UACnB,MAAM;AAAA,UACN,IAAI;AAAA,UACJ,OAAO,SAAS,6BAA6B,gBAAgB;AAAA,UAC7D,WAAW,UAAU,YAAY,QAAQ,MAAM;AAAA,QAChD,CAAC;AAAA,MACF;AAAA,IACD;AAEA,aAAS,yBAAyB,OAAmC;AACpE,UAAI,CAAC,OAAO;AACX,eAAO;AAAA,MACR;AACA,YAAM,QAAQ,MAAM,MAAM,qBAAqB;AAC/C,aAAO,QAAQ,MAAM,CAAC,IAAI;AAAA,IAC3B;AANS;AAQT,SAAK,MAAM,mBAAmB,gBAAgB,QAAQ,kBAAkB,eAAe,KAAK,SAAU,GAAG,GAAG;AAE3G,YAAM,QAAQ,yBAAyB,EAAE,KAAK,EAAE,YAAY;AAC5D,YAAM,SAAS,yBAAyB,EAAE,KAAK,EAAE,YAAY;AAE7D,aAAO,QAAQ,OAAO,MAAM;AAAA,IAC7B,CAAC,GAAG,kBAAkB,eAAe,cAAc,cAAc,oBAAoB,IAAI,SAAS,WAAW;AAAA,EAC9G;AAAA,EAEQ,MAAM,mBAAuC,gBAAiC,QAAqB,kBAAqC,gBAA2E,kBAAqC,eAA+B,cAA6B,cAA6B,oBAAqD,QAAgB,IAAI,aAAsB;AACvb,UAAM,kBAAyD;AAAA,MAC9D,cAAc,wBAAC,SAAoC;AAClD,YAAI,YAAY,MAAM;AACrB,eAAK,MAAM,mBAAmB,gBAAgB,QAAQ,kBAAkB,gBAAgB,kBAAkB,eAAe,cAAc,cAAc,oBAAoB,KAAK,QAAQ,WAAW;AAAA,QAClM,OAAO;AACN,cAAI,CAAC,kBAAkB;AACtB;AAAA,UACD;AACA,eAAK,eAAe,QAAQ,gBAAgB,kBAAkB,eAAe,cAAc,cAAc,oBAAoB,IAAI;AACjI,cAAI,YAAY,MAAM,GAAG;AACxB,6BAAiB,KAAK;AAAA,UACvB;AAAA,QACD;AAAA,MACD,GAZc;AAAA,MAad,eAAe;AAAA,MACf,QAAQ,wBAAC,SAA0D;AAElE,cAAM,kBAAkB,OAAO,gBAAgB,iBAAiB;AAEhE,YAAI,4BAA4B,IAAI,GAAG;AACtC,qBAAW,UAAU,cAAc,SAAS;AAE3C,gBAAI,OAAO,YAAY,CAAC,gBAAgB,IAAI,KAAK,kBAAkB,EAAE,UAAU,OAAO,SAAS,CAAC,CAAC,GAAG;AACnG,qBAAO;AAAA,YACR;AAAA,UACD;AACA,iBAAO;AAAA,QACR;AAEA,YAAI,UAAU,QAAQ,KAAK,SAAS,SAAS;AAC5C,iBAAO,CAAC,gBAAgB,IAAI,KAAK,EAAE;AAAA,QACpC;AAEA,YAAI,YAAY,QAAQ,KAAK,QAAQ;AACpC,iBAAO,CAAC,gBAAgB,IAAI,KAAK,kBAAkB,KAAK,OAAO,QAAQ,CAAC;AAAA,QACzE;AAEA,YAAI,QAAQ,OAAO,SAAS,YAAY,cAAc,QAAQ,IAAI,MAAM,KAAK,QAAQ,GAAG;AACvF,iBAAO,CAAC,QAAQ,MAAM,QAAQ,YAAY,EAAE,SAAS,KAAK,SAAS,MAAM,KACrE,CAAC,gBAAgB,IAAI,KAAK,kBAAkB,EAAE,UAAU,KAAK,SAAS,CAAC,CAAC;AAAA,QAC7E;AAEA,YAAI,QAAQ,OAAO,SAAS,YAAY,SAAS,QAAQ,KAAK,OAAO,KAAK,OAAO;AAChF,iBAAO,CAAC,gBAAgB,IAAI,KAAK,kBAAkB,EAAE,KAAK,KAAK,KAAK,OAAO,KAAK,MAAM,WAAW,CAAC,CAAC;AAAA,QACpG;AAEA,YAAI,EAAE,aAAa,SAAS,KAAK,IAAI;AACpC,iBAAO,CAAC,gBAAgB,IAAI,KAAK,EAAE;AAAA,QACpC;AAGA,eAAO;AAAA,MACR,GArCQ;AAAA,IAsCT;AACA,sBAAkB,YAAY,KAAK,OAAO;AAAA,MACzC,yBAAyB;AAAA,QACxB,4BAA4B;AAAA,QAC5B,2BAA2B;AAAA,QAC3B,sCAAsC;AAAA,MACvC;AAAA,MACA,aAAa,eAAe,SAAS,kCAAkC,oBAAoB;AAAA,MAC3F;AAAA,IACD,CAAC;AAAA,EACF;AACD;",
  "names": []
}
