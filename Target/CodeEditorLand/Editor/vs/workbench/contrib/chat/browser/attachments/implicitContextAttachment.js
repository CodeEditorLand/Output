var S=Object.defineProperty;var H=Object.getOwnPropertyDescriptor;var p=(n,a,i,t)=>{for(var e=t>1?void 0:t?H(a,i):a,r=n.length-1,s;r>=0;r--)(s=n[r])&&(e=(t?s(a,i,e):s(e))||e);return t&&e&&S(a,i,e),e},d=(n,a)=>(i,t)=>a(i,t,n);import*as l from"../../../../../base/browser/dom.js";import{Button as E}from"../../../../../base/browser/ui/button/button.js";import{getDefaultHoverDelegate as $}from"../../../../../base/browser/ui/hover/hoverDelegateFactory.js";import{Codicon as u}from"../../../../../base/common/codicons.js";import{Disposable as F,DisposableStore as R}from"../../../../../base/common/lifecycle.js";import{basename as x,dirname as C}from"../../../../../base/common/resources.js";import{URI as f}from"../../../../../base/common/uri.js";import{localize as o}from"../../../../../nls.js";import{FileKind as U}from"../../../../../platform/files/common/files.js";import{IHoverService as w}from"../../../../../platform/hover/browser/hover.js";import{ILabelService as B}from"../../../../../platform/label/common/label.js";import"../../../../browser/labels.js";import"../../common/chatModel.js";let c=class extends F{constructor(i,t,e,r){super();this.attachment=i;this.resourceLabels=t;this.labelService=e;this.hoverService=r;this.domNode=l.$(".chat-attached-context-attachment.show-file-icons.implicit"),this.render()}domNode;renderDisposables=this._register(new R);render(){l.clearNode(this.domNode),this.renderDisposables.clear(),this.domNode.classList.toggle("disabled",!this.attachment.enabled);const i=this.resourceLabels.create(this.domNode,{supportIcons:!0}),t=f.isUri(this.attachment.value)?this.attachment.value:this.attachment.value.uri,e=f.isUri(this.attachment.value)?void 0:this.attachment.value.range,r=x(t),s=C(t),m=`${r} ${s}`,v=e?o("chat.fileAttachmentWithRange","Attached file, {0}, line {1} to line {2}",m,e.startLineNumber,e.endLineNumber):o("chat.fileAttachment","Attached file, {0}",m),L=this.labelService.getUriLabel(t,{relative:!0}),N=o("openEditor","Current file context"),g=o("enableHint","disabled"),h=`${N+(this.attachment.enabled?"":` (${g})`)}
${L}`;i.setFile(t,{fileKind:U.FILE,hidePath:!0,range:e,title:h}),this.domNode.ariaLabel=v,this.domNode.tabIndex=0;const y=l.append(this.domNode,l.$("span.chat-implicit-hint",void 0,"Current file"));this._register(this.hoverService.setupManagedHover($("element"),y,h));const D=this.attachment.enabled?o("disable","Disable current file context"):o("enable","Enable current file context"),b=this.renderDisposables.add(new E(this.domNode,{supportIcons:!0,title:D}));b.icon=this.attachment.enabled?u.eye:u.eyeClosed,this.renderDisposables.add(b.onDidClick(I=>{I.stopPropagation(),this.attachment.enabled=!this.attachment.enabled}))}};c=p([d(2,B),d(3,w)],c);export{c as ImplicitContextAttachmentWidget};
