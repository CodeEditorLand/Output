var u=Object.defineProperty;var S=Object.getOwnPropertyDescriptor;var c=(o,a,e,t)=>{for(var s=t>1?void 0:t?S(a,e):a,l=o.length-1,n;l>=0;l--)(n=o[l])&&(s=(t?n(a,e,s):n(s))||s);return t&&s&&u(a,e,s),s},m=(o,a)=>(e,t)=>a(e,t,o);import{Emitter as b}from"../../../../../base/common/event.js";import{Disposable as v}from"../../../../../base/common/lifecycle.js";import{localize as C}from"../../../../../nls.js";import{IInstantiationService as D}from"../../../../../platform/instantiation/common/instantiation.js";import"../../common/chatModel.js";import{IChatService as f}from"../../common/chatService.js";import{isResponseVM as R}from"../../common/chatViewModel.js";import{IChatWidgetService as y}from"../chat.js";import{ChatConfirmationWidget as _}from"./chatConfirmationWidget.js";import"./chatContentParts.js";let p=class extends v{constructor(e,t,s,l,n){super();this.instantiationService=s;this.chatService=l;const r=t.element,I=e.buttons?e.buttons.map(i=>({label:i,data:e.data})):[{label:C("accept","Accept"),data:e.data},{label:C("dismiss","Dismiss"),data:e.data,isSecondary:!0}],h=this._register(this.instantiationService.createInstance(_,e.title,e.message,I));h.setShowButtons(!e.isUsed),this._register(h.onDidClick(async i=>{if(R(r)){const g=`${i.label}: "${e.title}"`,d=i.isSecondary?{rejectedConfirmationData:[i.data]}:{acceptedConfirmationData:[i.data]};d.agentId=r.agent?.id,d.slashCommand=r.slashCommand?.name,d.confirmation=i.label,d.userSelectedModelId=n.getWidgetBySessionId(r.sessionId)?.input.currentLanguageModel,await this.chatService.sendRequest(r.sessionId,g,d)&&(e.isUsed=!0,h.setShowButtons(!1),this._onDidChangeHeight.fire())}})),this.domNode=h.domNode}domNode;_onDidChangeHeight=this._register(new b);onDidChangeHeight=this._onDidChangeHeight.event;hasSameContent(e){return e.kind==="confirmation"}addDisposable(e){this._register(e)}};p=c([m(2,D),m(3,f),m(4,y)],p);export{p as ChatConfirmationContentPart};
