var nt=Object.defineProperty;var it=Object.getOwnPropertyDescriptor;var b=(o,t,e,n)=>{for(var i=n>1?void 0:n?it(t,e):t,r=o.length-1,s;r>=0;r--)(s=o[r])&&(i=(n?s(t,e,i):s(i))||i);return n&&i&&nt(t,e,i),i},m=(o,t)=>(e,n)=>t(e,n,o);import{BrowserFeatures as rt}from"../../../../base/browser/canIUse.js";import*as g from"../../../../base/browser/dom.js";import{StandardKeyboardEvent as st}from"../../../../base/browser/keyboardEvent.js";import{renderMarkdownAsPlaintext as ot}from"../../../../base/browser/markdownRenderer.js";import"../../../../base/browser/mouseEvent.js";import*as me from"../../../../base/browser/ui/aria/aria.js";import{Button as ie}from"../../../../base/browser/ui/button/button.js";import{SimpleIconLabel as Se}from"../../../../base/browser/ui/iconLabel/simpleIconLabel.js";import{InputBox as Ie}from"../../../../base/browser/ui/inputbox/inputBox.js";import{CachedListVirtualDelegate as at}from"../../../../base/browser/ui/list/list.js";import{DefaultStyleController as lt}from"../../../../base/browser/ui/list/listWidget.js";import{SelectBox as ct}from"../../../../base/browser/ui/selectBox/selectBox.js";import{Toggle as dt,unthemedToggleStyles as gt}from"../../../../base/browser/ui/toggle/toggle.js";import{ToolBar as ut}from"../../../../base/browser/ui/toolbar/toolbar.js";import{RenderIndentGuides as pt}from"../../../../base/browser/ui/tree/abstractTree.js";import"../../../../base/browser/ui/tree/objectTree.js";import{ObjectTreeModel as mt}from"../../../../base/browser/ui/tree/objectTreeModel.js";import{TreeVisibility as St}from"../../../../base/browser/ui/tree/tree.js";import{Action as B,Separator as Te}from"../../../../base/common/actions.js";import{distinct as It}from"../../../../base/common/arrays.js";import{Codicon as Tt}from"../../../../base/common/codicons.js";import{onUnexpectedError as fe}from"../../../../base/common/errors.js";import{Emitter as y,Event as D}from"../../../../base/common/event.js";import"../../../../base/common/jsonSchema.js";import{KeyCode as $}from"../../../../base/common/keyCodes.js";import{Disposable as Ee,DisposableStore as A,dispose as ft,isDisposable as re,toDisposable as se}from"../../../../base/common/lifecycle.js";import{isIOS as ve}from"../../../../base/common/platform.js";import{escapeRegExpCharacters as Et}from"../../../../base/common/strings.js";import{isDefined as V,isUndefinedOrNull as q}from"../../../../base/common/types.js";import{ILanguageService as vt}from"../../../../editor/common/languages/language.js";import{MarkdownRenderer as ht}from"../../../../editor/browser/widget/markdownRenderer/browser/markdownRenderer.js";import{localize as T}from"../../../../nls.js";import{IClipboardService as oe}from"../../../../platform/clipboard/common/clipboardService.js";import{ICommandService as he}from"../../../../platform/commands/common/commands.js";import{ConfigurationTarget as j,IConfigurationService as be,getLanguageTagSettingPlainKey as bt}from"../../../../platform/configuration/common/configuration.js";import{ConfigurationScope as yt}from"../../../../platform/configuration/common/configurationRegistry.js";import{IContextKeyService as xt}from"../../../../platform/contextkey/common/contextkey.js";import{IContextMenuService as ye,IContextViewService as xe}from"../../../../platform/contextview/browser/contextView.js";import{IInstantiationService as ae}from"../../../../platform/instantiation/common/instantiation.js";import{IKeybindingService as Lt}from"../../../../platform/keybinding/common/keybinding.js";import{IListService as Dt,WorkbenchObjectTree as Ct}from"../../../../platform/list/browser/listService.js";import"../../../../platform/log/common/log.js";import{IOpenerService as Ot}from"../../../../platform/opener/common/opener.js";import{IProductService as Le}from"../../../../platform/product/common/productService.js";import{ITelemetryService as _t}from"../../../../platform/telemetry/common/telemetry.js";import{defaultButtonStyles as le,getInputBoxStyle as De,getListStyles as kt,getSelectBoxStyles as wt}from"../../../../platform/theme/browser/defaultStyles.js";import{editorBackground as x,foreground as F}from"../../../../platform/theme/common/colorRegistry.js";import{IThemeService as Mt}from"../../../../platform/theme/common/themeService.js";import{IUserDataProfilesService as Nt}from"../../../../platform/userDataProfile/common/userDataProfile.js";import{getIgnoredSettings as ce}from"../../../../platform/userDataSync/common/settingsMerge.js";import{IUserDataSyncEnablementService as At,getDefaultIgnoredSettings as J}from"../../../../platform/userDataSync/common/userDataSync.js";import{IExtensionsWorkbenchService as Vt}from"../../extensions/common/extensions.js";import{settingsMoreActionIcon as jt}from"./preferencesIcons.js";import"./preferencesWidgets.js";import{SettingsTreeIndicatorsLabel as Ce,getIndicatorsLabelAriaLabel as Rt}from"./settingsEditorSettingIndicators.js";import"./settingsLayout.js";import{SettingsTreeGroupElement as H,SettingsTreeNewExtensionsElement as Oe,SettingsTreeSettingElement as R,inspectSetting as Bt,objectSettingSupportsRemoveDefaultValue as _e,settingKeyToDisplayFormat as Ht}from"./settingsTreeModels.js";import{ExcludeSettingWidget as Pt,IncludeSettingWidget as Ft,ListSettingWidget as Gt,ObjectSettingCheckboxWidget as ke,ObjectSettingDropdownWidget as Wt}from"./settingsWidgets.js";import{LANGUAGE_SETTING_TAG as Ut,SETTINGS_EDITOR_COMMAND_SHOW_CONTEXT_MENU as Kt,compareTwoNullableNumbers as we}from"../common/preferences.js";import{settingsNumberInputBackground as $t,settingsNumberInputBorder as qt,settingsNumberInputForeground as Jt,settingsSelectBackground as Xt,settingsSelectBorder as Yt,settingsSelectForeground as zt,settingsSelectListBorder as Qt,settingsTextInputBackground as Zt,settingsTextInputBorder as en,settingsTextInputForeground as tn}from"../common/settingsEditorColorRegistry.js";import{APPLY_ALL_PROFILES_SETTING as P,IWorkbenchConfigurationService as Me}from"../../../services/configuration/common/configuration.js";import{IWorkbenchEnvironmentService as nn}from"../../../services/environment/common/environmentService.js";import{IExtensionService as rn}from"../../../services/extensions/common/extensions.js";import{SETTINGS_AUTHORITY as sn,SettingValueType as h}from"../../../services/preferences/common/preferences.js";import{getInvalidTypeError as Ne}from"../../../services/preferences/common/preferencesValidation.js";import{getDefaultHoverDelegate as de}from"../../../../base/browser/ui/hover/hoverDelegateFactory.js";import{IHoverService as on}from"../../../../platform/hover/browser/hover.js";import{URI as an}from"../../../../base/common/uri.js";const S=g.$;function ln(o){const t=typeof o.defaultValue=="object"?o.defaultValue??{}:{},e=o.isConfigured?{...t,...o.scopeValue}:t;return Object.keys(e).filter(n=>!!e[n]).map(n=>{const i=t[n];let r;if(i===e[n]&&o.setting.type==="object"&&o.defaultValueSource instanceof Map){const c=o.defaultValueSource.get(`${o.setting.key}.${n}`);r=typeof c=="string"?c:c?.displayName}const s=e[n],a=typeof s=="boolean"?void 0:s.when;return{value:{type:"string",data:n},sibling:a,elementType:o.valueType,source:r}})}function cn(o,t){const e=new Set(o);return t.forEach(({key:n})=>e.delete(n.data)),e.size===0}function G(o){if(o.anyOf)return o.anyOf.map(G).flat();const t=o.enumDescriptions??[];return(o.enum??[]).map((e,n)=>{const i=n<t.length?t[n]:void 0;return{value:e,description:i}})}function W(o){return o.anyOf?o.anyOf.map(W).some(e=>e==="enum")?"enum":"string":o.type==="boolean"?"boolean":o.type==="string"&&V(o.enum)&&o.enum.length>0?"enum":"string"}function ge(o,t,e){return o==="boolean"?{type:o,data:!!t}:o==="enum"?{type:o,data:""+t,options:e}:{type:o,data:""+t}}function dn(o){const t=typeof o.defaultValue=="object"?o.defaultValue??{}:{},e=typeof o.scopeValue=="object"?o.scopeValue??{}:{},n=o.isConfigured?{...t,...e}:t,{objectProperties:i,objectPatternProperties:r,objectAdditionalProperties:s}=o.setting,a=Object.entries(r??{}).map(([l,d])=>({pattern:new RegExp(l),schema:d})),c=Object.entries(i??{}).map(([l,d])=>({value:l,description:d.description}));return Object.keys(n).map(l=>{const d=t[l];let u;if(d===n[l]&&o.setting.type==="object"&&o.defaultValueSource instanceof Map){const E=o.defaultValueSource.get(`${o.setting.key}.${l}`);u=typeof E=="string"?E:E?.displayName}if(V(i)&&l in i){const E=G(i[l]);return{key:{type:"enum",data:l,options:c},value:ge(W(i[l]),n[l],E),keyDescription:i[l].description,removable:q(d),resetable:!q(d),source:u}}const f=d===void 0||_e(o.setting.key),v=!!d&&d!==n[l],I=a.find(({pattern:E})=>E.test(l))?.schema;if(I){const E=G(I);return{key:{type:"string",data:l},value:ge(W(I),n[l],E),keyDescription:I.description,removable:f,resetable:v,source:u}}const C=G(typeof s=="boolean"?{}:s??{});return{key:{type:"string",data:l},value:ge(typeof s=="object"?W(s):"string",n[l],C),keyDescription:typeof s=="object"?s.description:void 0,removable:f,resetable:v,source:u}}).filter(l=>!q(l.value.data))}function gn(o){const t=typeof o.defaultValue=="object"?o.defaultValue??{}:{},e=typeof o.scopeValue=="object"?o.scopeValue??{}:{},n=o.isConfigured?{...t,...e}:t,{objectProperties:i}=o.setting,r=[];for(const s in i){const a=t[s];let c;if(a===n[s]&&o.setting.type==="object"&&o.defaultValueSource instanceof Map){const l=o.defaultValueSource.get(s);c=typeof l=="string"?l:l?.displayName}r.push({key:{type:"string",data:s},value:{type:"boolean",data:!!n[s]},keyDescription:i[s].description,removable:!1,resetable:!0,source:c})}return r}function un(o){return(t,e)=>{const n=[];return o.setting.enum&&o.setting.enum.forEach((i,r)=>{if(!o.setting.uniqueItems||e!==void 0&&i===t[e]||!t.includes(i)){const s=o.setting.enumDescriptions?.[r];n.push({value:i,description:s})}}),n.length>0?{type:"enum",data:n[0].value,options:n}:void 0}}function pn(o){const{objectProperties:t}=o.setting,e=Object.keys(t??{});return n=>{const i=new Set(n),r=[];return e.forEach(s=>{i.has(s)||r.push({value:s,description:t[s].description})}),r.length>0?{type:"enum",data:r[0].value,options:r}:void 0}}function mn(o){const{objectProperties:t,objectPatternProperties:e,objectAdditionalProperties:n}=o.setting,i=Object.entries(e??{}).map(([r,s])=>({pattern:new RegExp(r),schema:s}));return r=>{let s;V(t)&&r in t&&(s=t[r]);const a=s??i.find(({pattern:c})=>c.test(r))?.schema;if(V(a)?s=a:V(n)&&typeof n=="object"&&(s=n),V(s)){const c=W(s);if(c==="boolean")return{type:c,data:s.default??!0};if(c==="enum"){const l=G(s);return{type:c,data:s.default??l[0].value,options:l}}else return{type:c,data:s.default??""}}}}function X(o){return o==="number"||o==="integer"}function Sn(o,t){const e={};for(const n in t){let i;const r=o.setting.objectPatternProperties,s=o.setting.objectProperties,a=o.setting.objectAdditionalProperties;if(s){for(const c in s)if(c===n){i=X(s[c].type);break}}if(i===void 0&&r){for(const c in r)if(n.match(c)){i=X(r[c].type);break}}i===void 0&&a&&typeof a!="boolean"&&X(a.type)&&(i=!0),e[n]=i?Number(t[n]):t[n]}return e}function In(o){if(!o.value||!Array.isArray(o.value))return[];if(o.setting.arrayItemType==="enum"){let t=[];return o.setting.enum&&(t=o.setting.enum.map((e,n)=>({value:e,description:o.setting.enumDescriptions?.[n]}))),o.value.map(e=>({value:{type:"enum",data:e,options:t}}))}else return o.value.map(t=>({value:{type:"string",data:t}}))}function Tn(o,t){return o.setting.enum&&o.setting.uniqueItems?o.setting.enum.length-t.length>0:!0}function kr(o,t,e){const n=je(t);return{tree:Ae(o,n,e),leftoverSettings:n}}function wr(o,t,e,n){return[...je(o)].filter(r=>r.restricted&&Bt(r.key,t,e,n).isConfigured)}async function Mr(o,t){const e=new Map,n=(s,a,c)=>{if(!e.has(s)){const l={id:s,label:a,children:[]};e.set(s,l)}e.get(s).children.push(c)},i=async s=>{const a=s.sections.map(f=>f.settings).flat(),c=s.extensionInfo.id,l=await o.getExtension(c),d=l?.displayName??l?.name??c,u={id:s.id||s.title,label:s.title,order:s.order,settings:a};n(c,d,u)},r=t.map(s=>i(s));return Promise.all(r).then(()=>{const s=[];for(const a of e.values()){for(const c of a.children)c.settings?.sort((l,d)=>we(l.order,d.order));if(a.children.length===1)s.push({id:a.id,label:a.children[0].label,settings:a.children[0].settings});else{a.children.sort((l,d)=>we(l.order,d.order));const c=a.children.find(l=>l.label===a.label);if(c&&!c.children){const l=a.children.filter(d=>d!==c);s.push({id:a.id,label:a.label,settings:c.settings,children:l})}else s.push(a)}}return s.sort((a,c)=>a.label.localeCompare(c.label)),{id:"extensions",label:T("extensions","Extensions"),children:s}})}function Ae(o,t,e){let n;o.children&&(n=o.children.map(r=>Ae(r,t,e)).filter(r=>r.children?.length||r.settings?.length));let i;if(o.settings&&(i=o.settings.map(r=>En(t,r,e)).flat()),!n&&!i)throw new Error(`TOC node has no child groups or settings: ${o.id}`);return{id:o.id,label:o.label,children:n,settings:i}}const fn=[/^settingsSync\..*/,/^sync\..*/,/^workbench.fontAliasing$/];function En(o,t,e){const n=[];return o.forEach(i=>{hn(i,t)&&(n.push(i),o.delete(i))}),!n.length&&!fn.some(i=>i.test(t))&&e.warn(`Settings pattern "${t}" doesn't match any settings`),n.sort((i,r)=>i.key.localeCompare(r.key))}const Ve=new Map;function vn(o){return o=Et(o).replace(/\\\*/g,".*"),new RegExp(`^${o}$`,"i")}function hn(o,t){let e=Ve.get(t);return e||(e=vn(t),Ve.set(t,e)),e.test(o.key)}function je(o){const t=new Set;for(const e of o)for(const n of e.sections)for(const i of n.settings)(!i.overrides||!i.overrides.length)&&t.add(i);return t}const Re="settings.text.template",Be="settings.multilineText.template",He="settings.number.template",Pe="settings.enum.template",Fe="settings.bool.template",Ge="settings.array.template",We="settings.exclude.template",Ue="settings.include.template",Ke="settings.object.template",$e="settings.boolObject.template",Y="settings.complex.template",qe="settings.newExtensions.template",Je="settings.group.template",Xe="settings.extensionToggle.template";function bn(o){o.querySelectorAll(`
		[tabindex="0"],
		input:not([tabindex="-1"]),
		select:not([tabindex="-1"]),
		textarea:not([tabindex="-1"]),
		a:not([tabindex="-1"]),
		button:not([tabindex="-1"]),
		area:not([tabindex="-1"])
	`).forEach(e=>{e.setAttribute(p.ELEMENT_FOCUSABLE_ATTR,"true"),e.setAttribute("tabindex","-1")})}function yn(o){o.querySelectorAll(`[${p.ELEMENT_FOCUSABLE_ATTR}="true"]`).forEach(e=>{e.removeAttribute(p.ELEMENT_FOCUSABLE_ATTR),e.setAttribute("tabindex","0")})}let p=class extends Ee{constructor(e,n,i,r,s,a,c,l,d,u,f,v,I,C,E){super();this.settingActions=e;this.disposableActionFactory=n;this._themeService=i;this._contextViewService=r;this._openerService=s;this._instantiationService=a;this._commandService=c;this._contextMenuService=l;this._keybindingService=d;this._configService=u;this._extensionsService=f;this._extensionsWorkbenchService=v;this._productService=I;this._telemetryService=C;this._hoverService=E;this.markdownRenderer=this._register(a.createInstance(ht,{})),this.ignoredSettings=ce(J(),this._configService),this._register(this._configService.onDidChangeConfiguration(L=>{this.ignoredSettings=ce(J(),this._configService),this._onDidChangeIgnoredSettings.fire()}))}static CONTROL_CLASS="setting-control-focus-target";static CONTROL_SELECTOR="."+this.CONTROL_CLASS;static CONTENTS_CLASS="setting-item-contents";static CONTENTS_SELECTOR="."+this.CONTENTS_CLASS;static ALL_ROWS_SELECTOR=".monaco-list-row";static SETTING_KEY_ATTR="data-key";static SETTING_ID_ATTR="data-id";static ELEMENT_FOCUSABLE_ATTR="data-focusable";_onDidClickOverrideElement=this._register(new y);onDidClickOverrideElement=this._onDidClickOverrideElement.event;_onDidChangeSetting=this._register(new y);onDidChangeSetting=this._onDidChangeSetting.event;_onDidOpenSettings=this._register(new y);onDidOpenSettings=this._onDidOpenSettings.event;_onDidClickSettingLink=this._register(new y);onDidClickSettingLink=this._onDidClickSettingLink.event;_onDidFocusSetting=this._register(new y);onDidFocusSetting=this._onDidFocusSetting.event;ignoredSettings;_onDidChangeIgnoredSettings=this._register(new y);onDidChangeIgnoredSettings=this._onDidChangeIgnoredSettings.event;_onDidChangeSettingHeight=this._register(new y);onDidChangeSettingHeight=this._onDidChangeSettingHeight.event;_onApplyFilter=this._register(new y);onApplyFilter=this._onApplyFilter.event;markdownRenderer;renderCommonTemplate(e,n,i){n.classList.add("setting-item"),n.classList.add("setting-item-"+i);const r=new A,s=g.append(n,S(p.CONTENTS_SELECTOR));s.classList.add("settings-row-inner-container");const a=g.append(s,S(".setting-item-title")),c=g.append(a,S(".setting-item-cat-label-container")),l=g.append(c,S("span.setting-item-category")),d=g.append(c,S("span.setting-item-label")),u=r.add(new Se(d)),f=this._instantiationService.createInstance(Ce,a);r.add(f);const v=g.append(s,S(".setting-item-description")),I=g.append(s,S(".setting-item-modified-indicator"));r.add(this._hoverService.setupManagedHover(de("mouse"),I,()=>T("modified","The setting has been configured in the current scope.")));const C=g.append(s,S(".setting-item-value")),E=g.append(C,S("div.setting-item-control")),L=g.append(s,S(".setting-item-deprecation-message")),O=g.append(s,S(".setting-toolbar-container")),pe=this.renderSettingToolbar(O),tt={toDispose:r,elementDisposables:r.add(new A),containerElement:s,categoryElement:l,labelElement:u,descriptionElement:v,controlElement:E,deprecationWarningElement:L,indicatorsLabel:f,toolbar:pe};return r.add(g.addDisposableListener(E,g.EventType.MOUSE_DOWN,ne=>ne.stopPropagation())),r.add(g.addDisposableListener(a,g.EventType.MOUSE_ENTER,ne=>s.classList.add("mouseover"))),r.add(g.addDisposableListener(a,g.EventType.MOUSE_LEAVE,ne=>s.classList.remove("mouseover"))),tt}addSettingElementFocusHandler(e){const n=g.trackFocus(e.containerElement);e.toDispose.add(n),n.onDidBlur(()=>{e.containerElement.classList.contains("focused")&&e.containerElement.classList.remove("focused")}),n.onDidFocus(()=>{e.containerElement.classList.add("focused"),e.context&&this._onDidFocusSetting.fire(e.context)})}renderSettingToolbar(e){const n=this._keybindingService.lookupKeybinding(Kt);let i=T("settingsContextMenuTitle","More Actions... ");return n&&(i+=` (${n&&n.getLabel()})`),new ut(e,this._contextMenuService,{toggleMenuTitle:i,renderDropdownAsChildElement:!ve,moreIcon:jt})}renderSettingElement(e,n,i){const r=e.element;r.inspectSelf(),i.context=r,i.toolbar.context=r;const s=this.disposableActionFactory(r.setting,r.settingsTarget);s.forEach(u=>re(u)&&i.elementDisposables.add(u)),i.toolbar.setActions([],[...this.settingActions,...s]);const a=r.setting;i.containerElement.classList.toggle("is-configured",r.isConfigured),i.containerElement.setAttribute(p.SETTING_KEY_ATTR,r.setting.key),i.containerElement.setAttribute(p.SETTING_ID_ATTR,r.id);const c=a.key+(r.isConfigured?" - Modified":"");if(i.categoryElement.textContent=r.displayCategory?r.displayCategory+": ":"",i.elementDisposables.add(this._hoverService.setupManagedHover(de("mouse"),i.categoryElement,c)),i.labelElement.text=r.displayLabel,i.labelElement.title=c,i.descriptionElement.innerText="",r.setting.descriptionIsMarkdown){const u=this.renderSettingMarkdown(r,i.containerElement,r.description,i.elementDisposables);i.descriptionElement.appendChild(u)}else i.descriptionElement.innerText=r.description;i.indicatorsLabel.updateScopeOverrides(r,this._onDidClickOverrideElement,this._onApplyFilter),i.elementDisposables.add(this._configService.onDidChangeConfiguration(u=>{u.affectsConfiguration(P)&&i.indicatorsLabel.updateScopeOverrides(r,this._onDidClickOverrideElement,this._onApplyFilter)}));const l=u=>this._onDidChangeSetting.fire({key:r.setting.key,value:u,type:i.context.valueType,manualReset:!1,scope:r.setting.scope}),d=r.setting.deprecationMessage||"";d&&r.setting.deprecationMessageIsMarkdown?(i.deprecationWarningElement.innerText="",i.deprecationWarningElement.appendChild(this.renderSettingMarkdown(r,i.containerElement,r.setting.deprecationMessage,i.elementDisposables))):i.deprecationWarningElement.innerText=d,i.deprecationWarningElement.prepend(S(".codicon.codicon-error")),i.containerElement.classList.toggle("is-deprecated",!!d),this.renderValue(r,i,l),i.indicatorsLabel.updateWorkspaceTrust(r),i.indicatorsLabel.updateSyncIgnored(r,this.ignoredSettings),i.indicatorsLabel.updateDefaultOverrideIndicator(r),i.indicatorsLabel.updatePreviewIndicator(r),i.elementDisposables.add(this.onDidChangeIgnoredSettings(()=>{i.indicatorsLabel.updateSyncIgnored(r,this.ignoredSettings)})),this.updateSettingTabbable(r,i),i.elementDisposables.add(r.onDidChangeTabbable(()=>{this.updateSettingTabbable(r,i)}))}updateSettingTabbable(e,n){e.tabbable?yn(n.containerElement):bn(n.containerElement)}renderSettingMarkdown(e,n,i,r){i=ue(i);const s=this.markdownRenderer.render({value:i,isTrusted:!0},{actionHandler:{callback:a=>{if(a.startsWith("#")){const c={source:e,targetKey:a.substring(1)};this._onDidClickSettingLink.fire(c)}else this._openerService.open(a,{allowCommands:!0}).catch(fe)},disposables:r},asyncRenderCallback:()=>{const a=n.clientHeight;a&&this._onDidChangeSettingHeight.fire({element:e,height:a})}});return r.add(s),s.element.classList.add("setting-item-markdown"),Ze(s.element),s.element}disposeTemplate(e){e.toDispose.dispose()}disposeElement(e,n,i,r){i.elementDisposables?.clear()}};p=b([m(2,Mt),m(3,xe),m(4,Ot),m(5,ae),m(6,he),m(7,ye),m(8,Lt),m(9,be),m(10,rn),m(11,Vt),m(12,Le),m(13,_t),m(14,on)],p);class xn{templateId=Je;renderTemplate(t){return t.classList.add("group-title"),{parent:t,toDispose:new A}}renderElement(t,e,n){n.parent.innerText="";const i=g.append(n.parent,S("div.settings-group-title-label.settings-row-inner-container"));i.classList.add(`settings-group-level-${t.element.level}`),i.textContent=t.element.label,t.element.isFirstGroup&&i.classList.add("settings-group-first")}disposeTemplate(t){}}let U=class{constructor(t){this._commandService=t}templateId=qe;renderTemplate(t){const e=new A;t.classList.add("setting-item-new-extensions");const n=new ie(t,{title:!0,...le});e.add(n),e.add(n.onDidClick(()=>{i.context&&this._commandService.executeCommand("workbench.extensions.action.showExtensionsWithIds",i.context.extensionIds)})),n.label=T("newExtensionsButtonLabel","Show matching extensions"),n.element.classList.add("settings-new-extensions-button");const i={button:n,toDispose:e};return i}renderElement(t,e,n){n.context=t.element}disposeTemplate(t){ft(t.toDispose)}};U=b([m(0,he)],U);class te extends p{static EDIT_IN_JSON_LABEL=T("editInSettingsJson","Edit in settings.json");templateId=Y;renderTemplate(t){const e=this.renderCommonTemplate(null,t,"complex"),n=g.append(e.controlElement,S("a.edit-in-settings-button"));n.classList.add(p.CONTROL_CLASS),n.role="button";const i=S(".setting-item-validation-message");e.containerElement.appendChild(i);const r={...e,button:n,validationErrorMessageElement:i};return this.addSettingElementFocusHandler(r),r}renderElement(t,e,n){super.renderSettingElement(t,e,n)}renderValue(t,e,n){const i=bt(t.setting.key),r=T("editLanguageSettingLabel","Edit settings for {0}",i),s=t.setting.isLanguageTagSetting;e.button.textContent=s?r:te.EDIT_IN_JSON_LABEL;const a=c=>{s?this._onApplyFilter.fire(`@${Ut}${i}`):this._onDidOpenSettings.fire(t.setting.key),c.preventDefault(),c.stopPropagation()};e.elementDisposables.add(g.addDisposableListener(e.button,g.EventType.CLICK,c=>{a(c)})),e.elementDisposables.add(g.addDisposableListener(e.button,g.EventType.KEY_DOWN,c=>{const l=new st(c);(l.equals($.Space)||l.equals($.Enter))&&a(c)})),this.renderValidations(t,e),s?e.button.setAttribute("aria-label",r):e.button.setAttribute("aria-label",`${te.EDIT_IN_JSON_LABEL}: ${t.setting.key}`)}renderValidations(t,e){const n=t.isConfigured&&Ne(t.value,t.setting.type);if(n){e.containerElement.classList.add("invalid-input"),e.validationErrorMessageElement.innerText=n;return}e.containerElement.classList.remove("invalid-input")}}class Ln extends p{templateId=Ge;renderTemplate(t){const e=this.renderCommonTemplate(null,t,"list"),n=e.containerElement.querySelector(".setting-item-description"),i=S(".setting-item-validation-message");n.after(i);const r=this._instantiationService.createInstance(Gt,e.controlElement);r.domNode.classList.add(p.CONTROL_CLASS),e.toDispose.add(r);const s={...e,listWidget:r,validationErrorMessageElement:i};return this.addSettingElementFocusHandler(s),e.toDispose.add(r.onDidChangeList(a=>{const c=this.computeNewList(s,a);s.onChange?.(c)})),s}computeNewList(t,e){if(t.context){let n=[];if(Array.isArray(t.context.scopeValue)?n=[...t.context.scopeValue]:Array.isArray(t.context.value)&&(n=[...t.context.value]),e.type==="move"){const i=e.sourceIndex,r=e.targetIndex,s=n.splice(i,1)[0];n.splice(r,0,s)}else if(e.type==="remove"||e.type==="reset")n.splice(e.targetIndex,1);else if(e.type==="change"){const i=e.newItem.value.data.toString();e.targetIndex>-1?n[e.targetIndex]=i:n.push(i)}else e.type==="add"&&n.push(e.newItem.value.data.toString());return t.context.defaultValue&&Array.isArray(t.context.defaultValue)&&t.context.defaultValue.length===n.length&&t.context.defaultValue.join()===n.join()?void 0:n}}renderElement(t,e,n){super.renderSettingElement(t,e,n)}renderValue(t,e,n){const i=In(t),r=t.setting.enum?un(t):void 0;e.listWidget.setValue(i,{showAddButton:Tn(t,i),keySuggester:r}),e.context=t,e.elementDisposables.add(se(()=>{e.listWidget.cancelEdit()})),e.onChange=s=>{if(s&&!Z(t,e,s,!1)){const a=t.setting.arrayItemType,c=X(a)?s.map(l=>+l):s;n(c)}else n(s)},Z(t,e,i.map(s=>s.value.data.toString()),!0)}}class Ye extends p{renderTemplateWithWidget(t,e){e.domNode.classList.add(p.CONTROL_CLASS),t.toDispose.add(e);const n=t.containerElement.querySelector(".setting-item-description"),i=S(".setting-item-validation-message");n.after(i);const r={...t,validationErrorMessageElement:i};return e instanceof ke?r.objectCheckboxWidget=e:r.objectDropdownWidget=e,this.addSettingElementFocusHandler(r),r}renderElement(t,e,n){super.renderSettingElement(t,e,n)}}class Dn extends Ye{templateId=Ke;renderTemplate(t){const e=this.renderCommonTemplate(null,t,"list"),n=this._instantiationService.createInstance(Wt,e.controlElement),i=this.renderTemplateWithWidget(e,n);return e.toDispose.add(n.onDidChangeList(r=>{this.onDidChangeObject(i,r)})),i}onDidChangeObject(t,e){const n=t.objectDropdownWidget;if(t.context){const i=_e(t.context.setting.key),r=typeof t.context.defaultValue=="object"?t.context.defaultValue??{}:{},s=typeof t.context.scopeValue=="object"?t.context.scopeValue??{}:{},a={...t.context.scopeValue},c=[];if(n.items.forEach((d,u)=>{(e.type==="change"||e.type==="move")&&e.targetIndex===u?(e.originalItem.key.data!==e.newItem.key.data&&i&&e.originalItem.key.data in r?a[e.originalItem.key.data]=null:delete a[e.originalItem.key.data],a[e.newItem.key.data]=e.newItem.value.data,c.push(e.newItem)):(e.type!=="change"&&e.type!=="move"||e.newItem.key.data!==d.key.data)&&(a[d.key.data]=d.value.data,c.push(d))}),e.type==="remove"||e.type==="reset"){const d=e.originalItem.key.data,u=e.type==="remove"&&i&&r[d]===e.originalItem.value.data;u?a[d]=null:delete a[d];const f=c.findIndex(I=>I.key.data===d),v=r[d];u||q(r[d])&&f>-1?c.splice(f,1):!u&&f>-1&&(c[f].value.data=v)}else e.type==="add"&&(a[e.newItem.key.data]=e.newItem.value.data,c.push(e.newItem));Object.entries(a).forEach(([d,u])=>{s[d]!==u&&r[d]===u&&!(i&&u===null)&&delete a[d]});const l=Object.keys(a).length===0?void 0:a;t.objectDropdownWidget.setValue(c),t.onChange?.(l)}}renderValue(t,e,n){const i=dn(t),{key:r,objectProperties:s,objectPatternProperties:a,objectAdditionalProperties:c}=t.setting;e.objectDropdownWidget.setValue(i,{settingKey:r,showAddButton:c===!1?!cn(Object.keys(s??{}),i)||V(a):!0,keySuggester:pn(t),valueSuggester:mn(t)}),e.context=t,e.elementDisposables.add(se(()=>{e.objectDropdownWidget.cancelEdit()})),e.onChange=l=>{if(l&&!Z(t,e,l,!1)){const d=Sn(t,l);n(d)}else n(l)},Z(t,e,t.value,!0)}}class Cn extends Ye{templateId=$e;renderTemplate(t){const e=this.renderCommonTemplate(null,t,"list"),n=this._instantiationService.createInstance(ke,e.controlElement),i=this.renderTemplateWithWidget(e,n);return e.toDispose.add(n.onDidChangeList(r=>{this.onDidChangeObject(i,r)})),i}onDidChangeObject(t,e){if(t.context){const n=t.objectCheckboxWidget,i=typeof t.context.defaultValue=="object"?t.context.defaultValue??{}:{},r=typeof t.context.scopeValue=="object"?t.context.scopeValue??{}:{},s={...t.context.scopeValue},a=[];if(e.type!=="change")return;n.items.forEach((l,d)=>{e.targetIndex===d?(s[e.newItem.key.data]=e.newItem.value.data,a.push(e.newItem)):e.newItem.key.data!==l.key.data&&(s[l.key.data]=l.value.data,a.push(l))}),Object.entries(s).forEach(([l,d])=>{r[l]!==d&&i[l]===d&&delete s[l]});const c=Object.keys(s).length===0?void 0:s;t.objectCheckboxWidget.setValue(a),t.onChange?.(c),this._onDidFocusSetting.fire(t.context)}}renderValue(t,e,n){const i=gn(t),{key:r}=t.setting;e.objectCheckboxWidget.setValue(i,{settingKey:r}),e.context=t,e.onChange=s=>{n(s)}}}class ze extends p{renderTemplate(t){const e=this.renderCommonTemplate(null,t,"list"),n=this._instantiationService.createInstance(this.isExclude()?Pt:Ft,e.controlElement);n.domNode.classList.add(p.CONTROL_CLASS),e.toDispose.add(n);const i={...e,includeExcludeWidget:n};return this.addSettingElementFocusHandler(i),e.toDispose.add(n.onDidChangeList(r=>this.onDidChangeIncludeExclude(i,r))),i}onDidChangeIncludeExclude(t,e){if(t.context){let r=function(s){const a=Object.keys(s).sort((l,d)=>l.localeCompare(d)),c={};for(const l of a)c[l]=s[l];return c};var n=r;const i={...t.context.scopeValue};e.type!=="add"&&(e.originalItem.value.data.toString()in t.context.defaultValue?i[e.originalItem.value.data.toString()]=!1:delete i[e.originalItem.value.data.toString()]),(e.type==="change"||e.type==="add"||e.type==="move")&&(e.newItem.value.data.toString()in t.context.defaultValue&&!e.newItem.sibling?delete i[e.newItem.value.data.toString()]:i[e.newItem.value.data.toString()]=e.newItem.sibling?{when:e.newItem.sibling}:!0),this._onDidChangeSetting.fire({key:t.context.setting.key,value:Object.keys(i).length===0?void 0:r(i),type:t.context.valueType,manualReset:!1,scope:t.context.setting.scope})}}renderElement(t,e,n){super.renderSettingElement(t,e,n)}renderValue(t,e,n){const i=ln(t);e.includeExcludeWidget.setValue(i),e.context=t,e.elementDisposables.add(se(()=>{e.includeExcludeWidget.cancelEdit()}))}}class On extends ze{templateId=We;isExclude(){return!0}}class _n extends ze{templateId=Ue;isExclude(){return!1}}const kn=De({inputBackground:Zt,inputForeground:tn,inputBorder:en});class Qe extends p{MULTILINE_MAX_HEIGHT=150;renderTemplate(t,e){const n=this.renderCommonTemplate(null,t,"text"),i=g.append(n.containerElement,S(".setting-item-validation-message")),r={flexibleHeight:e,flexibleWidth:!1,flexibleMaxHeight:this.MULTILINE_MAX_HEIGHT,inputBoxStyles:kn},s=new Ie(n.controlElement,this._contextViewService,r);n.toDispose.add(s),n.toDispose.add(s.onDidChange(c=>{a.onChange?.(c)})),n.toDispose.add(s),s.inputElement.classList.add(p.CONTROL_CLASS),s.inputElement.tabIndex=0;const a={...n,inputBox:s,validationErrorMessageElement:i};return this.addSettingElementFocusHandler(a),a}renderElement(t,e,n){super.renderSettingElement(t,e,n)}renderValue(t,e,n){e.onChange=void 0,e.inputBox.value=t.value,e.inputBox.setAriaLabel(t.setting.key),e.onChange=i=>{Q(t,e,!1)||n(i)},Q(t,e,!0)}}class wn extends Qe{templateId=Re;renderTemplate(t){const e=super.renderTemplate(t,!1);return e.toDispose.add(g.addStandardDisposableListener(e.inputBox.inputElement,g.EventType.KEY_DOWN,n=>{(n.equals($.UpArrow)||n.equals($.DownArrow))&&n.preventDefault()})),e}}class Mn extends Qe{templateId=Be;renderTemplate(t){return super.renderTemplate(t,!0)}renderValue(t,e,n){const i=r=>{t.value=r,n(r)};super.renderValue(t,e,i),e.elementDisposables.add(e.inputBox.onDidHeightChange(r=>{e.containerElement.clientHeight&&this._onDidChangeSettingHeight.fire({element:t,height:e.containerElement.clientHeight})})),e.inputBox.layout()}}class Nn extends p{templateId=Pe;renderTemplate(t){const e=this.renderCommonTemplate(null,t,"enum"),n=wt({selectBackground:Xt,selectForeground:zt,selectBorder:Yt,selectListBorder:Qt}),i=new ct([],0,this._contextViewService,n,{useCustomDrawn:!(ve&&rt.pointerEvents)});e.toDispose.add(i),i.render(e.controlElement);const r=e.controlElement.querySelector("select");r&&(r.classList.add(p.CONTROL_CLASS),r.tabIndex=0),e.toDispose.add(i.onDidSelect(c=>{a.onChange?.(c.index)}));const s=e.containerElement.insertBefore(S(".setting-item-enumDescription"),e.descriptionElement.nextSibling),a={...e,selectBox:i,selectElement:r,enumDescriptionElement:s};return this.addSettingElementFocusHandler(a),a}renderElement(t,e,n){super.renderSettingElement(t,e,n)}renderValue(t,e,n){const i=t.setting.enumItemLabels?[...t.setting.enumItemLabels]:[],r=t.setting.enumDescriptions?[...t.setting.enumDescriptions]:[],s=[...t.setting.enum],a=t.setting.enumDescriptionsAreMarkdown,c=new A;e.elementDisposables.add(c);let l=!1;s.includes(t.defaultValue)||(s.unshift(t.defaultValue),r.unshift(""),i.unshift(""),l=!0);const d=et(String(t.defaultValue)),u=s.map(String).map(et).map((v,I)=>{const C=r[I]&&(a?ue(r[I],!1):r[I]);return{text:i[I]?i[I]:v,detail:i[I]?v:"",description:C,descriptionIsMarkdown:a,descriptionMarkdownActionHandler:{callback:E=>{this._openerService.open(E).catch(fe)},disposables:c},decoratorRight:v===d||l&&I===0?T("settings.Default","default"):""}});e.selectBox.setOptions(u),e.selectBox.setAriaLabel(t.setting.key);let f=s.indexOf(t.value);f===-1&&(f=0),e.onChange=void 0,e.selectBox.select(f),e.onChange=v=>{n(l&&v===0?t.defaultValue:s[v])},e.enumDescriptionElement.innerText=""}}const An=De({inputBackground:$t,inputForeground:Jt,inputBorder:qt});class Vn extends p{templateId=He;renderTemplate(t){const e=super.renderCommonTemplate(null,t,"number"),n=g.append(e.containerElement,S(".setting-item-validation-message")),i=new Ie(e.controlElement,this._contextViewService,{type:"number",inputBoxStyles:An});e.toDispose.add(i),e.toDispose.add(i.onDidChange(s=>{r.onChange?.(s)})),e.toDispose.add(i),i.inputElement.classList.add(p.CONTROL_CLASS),i.inputElement.tabIndex=0;const r={...e,inputBox:i,validationErrorMessageElement:n};return this.addSettingElementFocusHandler(r),r}renderElement(t,e,n){super.renderSettingElement(t,e,n)}renderValue(t,e,n){const i=t.valueType==="integer"||t.valueType==="nullable-integer"?parseInt:parseFloat,r=t.valueType==="nullable-integer"||t.valueType==="nullable-number"?s=>s===""?null:i(s):i;e.onChange=void 0,e.inputBox.value=typeof t.value=="number"?t.value.toString():"",e.inputBox.step=t.valueType.includes("integer")?"1":"any",e.inputBox.setAriaLabel(t.setting.key),e.onChange=s=>{Q(t,e,!1)||n(r(s))},Q(t,e,!0)}}class jn extends p{templateId=Fe;renderTemplate(t){t.classList.add("setting-item"),t.classList.add("setting-item-bool");const e=new A,n=g.append(t,S(p.CONTENTS_SELECTOR));n.classList.add("settings-row-inner-container");const i=g.append(n,S(".setting-item-title")),r=g.append(i,S("span.setting-item-category")),s=g.append(i,S("span.setting-item-label")),a=e.add(new Se(s)),c=this._instantiationService.createInstance(Ce,i),l=g.append(n,S(".setting-item-value-description")),d=g.append(l,S(".setting-item-bool-control")),u=g.append(l,S(".setting-item-description")),f=g.append(n,S(".setting-item-modified-indicator"));e.add(this._hoverService.setupManagedHover(de("mouse"),f,T("modified","The setting has been configured in the current scope.")));const v=g.append(n,S(".setting-item-deprecation-message")),I=new dt({icon:Tt.check,actionClassName:"setting-value-checkbox",isChecked:!0,title:"",...gt});d.appendChild(I.domNode),e.add(I),e.add(I.onChange(()=>{L.onChange(I.checked)})),e.add(g.addDisposableListener(u,g.EventType.MOUSE_DOWN,O=>{O.target.tagName.toLowerCase()!=="a"&&(L.checkbox.checked=!L.checkbox.checked,L.onChange(I.checked)),g.EventHelper.stop(O)})),I.domNode.classList.add(p.CONTROL_CLASS);const C=g.append(n,S(".setting-toolbar-container")),E=this.renderSettingToolbar(C);e.add(E);const L={toDispose:e,elementDisposables:e.add(new A),containerElement:n,categoryElement:r,labelElement:a,controlElement:d,checkbox:I,descriptionElement:u,deprecationWarningElement:v,indicatorsLabel:c,toolbar:E};return this.addSettingElementFocusHandler(L),e.add(g.addDisposableListener(d,"mousedown",O=>O.stopPropagation())),e.add(g.addDisposableListener(i,g.EventType.MOUSE_ENTER,O=>n.classList.add("mouseover"))),e.add(g.addDisposableListener(i,g.EventType.MOUSE_LEAVE,O=>n.classList.remove("mouseover"))),L}renderElement(t,e,n){super.renderSettingElement(t,e,n)}renderValue(t,e,n){e.onChange=void 0,e.checkbox.checked=t.value,e.checkbox.setTitle(t.setting.key),e.onChange=n}}class Rn extends p{templateId=Xe;_onDidDismissExtensionSetting=this._register(new y);onDidDismissExtensionSetting=this._onDidDismissExtensionSetting.event;renderTemplate(t){const e=super.renderCommonTemplate(null,t,"extension-toggle"),n=new ie(e.containerElement,{title:!1,...le});n.element.classList.add("setting-item-extension-toggle-button"),n.label=T("showExtension","Show Extension");const i=new ie(e.containerElement,{title:!1,secondary:!0,...le});i.element.classList.add("setting-item-extension-dismiss-button"),i.label=T("dismiss","Dismiss");const r={...e,actionButton:n,dismissButton:i};return this.addSettingElementFocusHandler(r),r}renderElement(t,e,n){super.renderSettingElement(t,e,n)}renderValue(t,e,n){e.elementDisposables.clear();const i=t.setting.displayExtensionId;e.elementDisposables.add(e.actionButton.onDidClick(async()=>{this._telemetryService.publicLog2("ManageExtensionClick",{extensionId:i}),this._commandService.executeCommand("extension.open",i)})),e.elementDisposables.add(e.dismissButton.onDidClick(async()=>{this._telemetryService.publicLog2("DismissExtensionClick",{extensionId:i}),this._onDidDismissExtensionSetting.fire(i)}))}}let z=class extends Ee{constructor(e,n,i,r){super();this._instantiationService=e;this._contextMenuService=n;this._contextViewService=i;this._userDataSyncEnablementService=r;this.settingActions=[new B("settings.resetSetting",T("resetSettingLabel","Reset Setting"),void 0,void 0,async d=>{d instanceof R&&(d.isUntrusted||this._onDidChangeSetting.fire({key:d.setting.key,value:void 0,type:d.setting.type,manualReset:!0,scope:d.setting.scope}))}),new Te,this._instantiationService.createInstance(_),this._instantiationService.createInstance(k),this._instantiationService.createInstance(w)];const s=(d,u)=>this.getActionsForSetting(d,u),a=d=>[],c=this._instantiationService.createInstance(Rn,[],a),l=[this._instantiationService.createInstance(jn,this.settingActions,s),this._instantiationService.createInstance(Vn,this.settingActions,s),this._instantiationService.createInstance(Ln,this.settingActions,s),this._instantiationService.createInstance(te,this.settingActions,s),this._instantiationService.createInstance(wn,this.settingActions,s),this._instantiationService.createInstance(Mn,this.settingActions,s),this._instantiationService.createInstance(On,this.settingActions,s),this._instantiationService.createInstance(_n,this.settingActions,s),this._instantiationService.createInstance(Nn,this.settingActions,s),this._instantiationService.createInstance(Dn,this.settingActions,s),this._instantiationService.createInstance(Cn,this.settingActions,s),c];this.onDidClickOverrideElement=D.any(...l.map(d=>d.onDidClickOverrideElement)),this.onDidChangeSetting=D.any(...l.map(d=>d.onDidChangeSetting),this._onDidChangeSetting.event),this.onDidDismissExtensionSetting=c.onDidDismissExtensionSetting,this.onDidOpenSettings=D.any(...l.map(d=>d.onDidOpenSettings)),this.onDidClickSettingLink=D.any(...l.map(d=>d.onDidClickSettingLink)),this.onDidFocusSetting=D.any(...l.map(d=>d.onDidFocusSetting)),this.onDidChangeSettingHeight=D.any(...l.map(d=>d.onDidChangeSettingHeight)),this.onApplyFilter=D.any(...l.map(d=>d.onApplyFilter)),this.allRenderers=[...l,this._instantiationService.createInstance(xn),this._instantiationService.createInstance(U)]}onDidClickOverrideElement;_onDidChangeSetting=this._register(new y);onDidChangeSetting;onDidDismissExtensionSetting;onDidOpenSettings;onDidClickSettingLink;onDidFocusSetting;onDidChangeSettingHeight;onApplyFilter;allRenderers;settingActions;getActionsForSetting(e,n){const i=[];return e.scope!==yt.APPLICATION&&n===j.USER_LOCAL&&i.push(this._instantiationService.createInstance(N,e)),this._userDataSyncEnablementService.isEnabled()&&!e.disallowSyncIgnore&&i.push(this._instantiationService.createInstance(M,e)),i.length&&i.splice(0,0,new Te),i}cancelSuggesters(){this._contextViewService.hideContextView()}showContextMenu(e,n){const i=n.querySelector(".monaco-toolbar");i&&this._contextMenuService.showContextMenu({getActions:()=>this.settingActions,getAnchor:()=>i,getActionsContext:()=>e})}getSettingDOMElementForDOMElement(e){const n=g.findParentWithClass(e,p.CONTENTS_CLASS);return n||null}getDOMElementsForSettingKey(e,n){return e.querySelectorAll(`[${p.SETTING_KEY_ATTR}="${n}"]`)}getKeyForDOMElementInSetting(e){const n=this.getSettingDOMElementForDOMElement(e);return n&&n.getAttribute(p.SETTING_KEY_ATTR)}getIdForDOMElementInSetting(e){const n=this.getSettingDOMElementForDOMElement(e);return n&&n.getAttribute(p.SETTING_ID_ATTR)}dispose(){super.dispose(),this.settingActions.forEach(e=>{re(e)&&e.dispose()}),this.allRenderers.forEach(e=>{re(e)&&e.dispose()})}};z=b([m(0,ae),m(1,ye),m(2,xe),m(3,At)],z);function Q(o,t,e){if(o.setting.validator){const n=o.setting.validator(t.inputBox.value);if(n){t.containerElement.classList.add("invalid-input"),t.validationErrorMessageElement.innerText=n;const i=T("validationError","Validation Error.");return t.inputBox.inputElement.parentElement.setAttribute("aria-label",[i,n].join(" ")),e||me.status(i+" "+n),!0}else t.inputBox.inputElement.parentElement.removeAttribute("aria-label")}return t.containerElement.classList.remove("invalid-input"),!1}function Z(o,t,e,n){if(t.containerElement.classList.add("invalid-input"),o.setting.validator){const i=o.setting.validator(e);if(i&&i!==""){t.containerElement.classList.add("invalid-input"),t.validationErrorMessageElement.innerText=i;const r=T("validationError","Validation Error.");return t.containerElement.setAttribute("aria-label",[o.setting.key,r,i].join(" ")),n||me.status(r+" "+i),!0}else t.containerElement.setAttribute("aria-label",o.setting.key),t.containerElement.classList.remove("invalid-input")}return!1}function Ze(o){for(let t=0;t<o.childNodes.length;t++){const e=o.childNodes.item(t);(e.tagName&&e.tagName.toLowerCase())==="img"?e.remove():Ze(e)}}function ue(o,t=!0){return o.replace(/`#([^#\s`]+)#`|'#([^#\s']+)#'/g,(e,n,i)=>{const r=n??i,s=Ht(r),a=`${s.category}: ${s.label}`;return t?`[${a}](#${r} "${r}")`:`"${a}"`})}function et(o){return o&&o.replace(/\n/g,"\\n").replace(/\r/g,"\\r")}let K=class{constructor(t,e){this.viewState=t;this.environmentService=e}filter(t,e){if(this.viewState.filterToCategory&&t instanceof R&&!this.settingContainedInGroup(t.setting,this.viewState.filterToCategory))return!1;if(t instanceof R&&this.viewState.settingsTarget!==j.USER_LOCAL){const n=!!this.environmentService.remoteAuthority;if(!t.matchesScope(this.viewState.settingsTarget,n))return!1}return t instanceof H?typeof t.count=="number"?t.count>0:St.Recurse:!(t instanceof Oe&&(this.viewState.tagFilters?.size||this.viewState.filterToCategory))}settingContainedInGroup(t,e){return e.children.some(n=>n instanceof H?this.settingContainedInGroup(t,n):n instanceof R?n.setting.key===t.key:!1)}};K=b([m(1,nn)],K);class Bn extends at{getTemplateId(t){if(t instanceof H)return Je;if(t instanceof R)return t.valueType===h.ExtensionToggle?Xe:t.isConfigured&&Ne(t.value,t.setting.type)?Y:t.valueType===h.Boolean?Fe:t.valueType===h.Integer||t.valueType===h.Number||t.valueType===h.NullableInteger||t.valueType===h.NullableNumber?He:t.valueType===h.MultilineString?Be:t.valueType===h.String?Re:t.valueType===h.Enum?Pe:t.valueType===h.Array?Ge:t.valueType===h.Exclude?We:t.valueType===h.Include?Ue:t.valueType===h.Object?Ke:t.valueType===h.BooleanObject?$e:(t.valueType===h.LanguageTag,Y);if(t instanceof Oe)return qe;throw new Error("unknown element type: "+t)}hasDynamicHeight(t){return!(t instanceof H)}estimateHeight(t){return t instanceof H?42:t instanceof R&&t.valueType===h.Boolean?78:104}}class Hn extends mt{isCollapsible(t){return!1}setCollapsed(t,e,n){return!1}}class Pn{constructor(t,e,n){this.configurationService=t;this.languageService=e;this.userDataProfilesService=n}getAriaLabel(t){if(t instanceof R){const e=[];if(e.push(`${t.displayCategory} ${t.displayLabel}.`),t.isConfigured){const r=T("settings.Modified","Modified.");e.push(r)}const n=Rt(t,this.configurationService,this.userDataProfilesService,this.languageService);n.length&&e.push(`${n}.`);const i=ot({value:ue(t.description,!1)});return i.length&&e.push(i),e.join(" ")}else return t instanceof H?t.label:t.id}getWidgetAriaLabel(){return T("settings","Settings")}}let ee=class extends Ct{constructor(t,e,n,i,r,s,a,c,l){super("SettingsTree",t,new Bn,n,{horizontalScrolling:!1,supportDynamicHeights:!0,identityProvider:{getId(d){return d.id}},accessibilityProvider:new Pn(s,c,l),styleController:d=>new lt(g.createStyleSheet(t),d),filter:a.createInstance(K,e),smoothScrolling:s.getValue("workbench.list.smoothScrolling"),multipleSelectionSupport:!1,findWidgetEnabled:!1,renderIndentGuides:pt.None,transformOptimization:!1},a,i,r,s),this.getHTMLElement().classList.add("settings-editor-tree"),this.style(kt({listBackground:x,listActiveSelectionBackground:x,listActiveSelectionForeground:F,listFocusAndSelectionBackground:x,listFocusAndSelectionForeground:F,listFocusBackground:x,listFocusForeground:F,listHoverForeground:F,listHoverBackground:x,listHoverOutline:x,listFocusOutline:x,listInactiveSelectionBackground:x,listInactiveSelectionForeground:F,listInactiveFocusBackground:x,listInactiveFocusOutline:x,treeIndentGuidesStroke:void 0,treeInactiveIndentGuidesStroke:void 0})),this.disposables.add(s.onDidChangeConfiguration(d=>{d.affectsConfiguration("workbench.list.smoothScrolling")&&this.updateOptions({smoothScrolling:s.getValue("workbench.list.smoothScrolling")})}))}createModel(t,e){return new Hn(t,e)}};ee=b([m(3,xt),m(4,Dt),m(5,Me),m(6,ae),m(7,vt),m(8,Nt)],ee);let _=class extends B{constructor(e){super(_.ID,_.LABEL);this.clipboardService=e}static ID="settings.copySettingId";static LABEL=T("copySettingIdLabel","Copy Setting ID");async run(e){return e&&await this.clipboardService.writeText(e.setting.key),Promise.resolve(void 0)}};_=b([m(0,oe)],_);let k=class extends B{constructor(e){super(k.ID,k.LABEL);this.clipboardService=e}static ID="settings.copySettingAsJSON";static LABEL=T("copySettingAsJSONLabel","Copy Setting as JSON");async run(e){if(e){const n=`"${e.setting.key}": ${JSON.stringify(e.value,void 0,"  ")}`;await this.clipboardService.writeText(n)}return Promise.resolve(void 0)}};k=b([m(0,oe)],k);let w=class extends B{constructor(e,n){super(w.ID,w.LABEL);this.clipboardService=e;this.productService=n}static ID="settings.copySettingAsURL";static LABEL=T("copySettingAsURLLabel","Copy Setting as URL");async run(e){if(e){const n=e.setting.key,i=this.productService.urlProtocol,r=an.from({scheme:i,authority:sn,path:`/${n}`},!0);await this.clipboardService.writeText(r.toString())}return Promise.resolve(void 0)}};w=b([m(0,oe),m(1,Le)],w);let M=class extends B{constructor(e,n){super(M.ID,M.LABEL);this.setting=e;this.configService=n;this._register(D.filter(n.onDidChangeConfiguration,i=>i.affectsConfiguration("settingsSync.ignoredSettings"))(()=>this.update())),this.update()}static ID="settings.stopSyncingSetting";static LABEL=T("stopSyncingSetting","Sync This Setting");async update(){const e=ce(J(),this.configService);this.checked=!e.includes(this.setting.key)}async run(){let e=[...this.configService.getValue("settingsSync.ignoredSettings")];e=e.filter(s=>s!==this.setting.key&&s!==`-${this.setting.key}`);const i=J().includes(this.setting.key),r=!this.checked;return r&&i&&e.push(`-${this.setting.key}`),!r&&!i&&e.push(this.setting.key),this.configService.updateValue("settingsSync.ignoredSettings",e.length?e:void 0,j.USER),Promise.resolve(void 0)}};M=b([m(1,be)],M);let N=class extends B{constructor(e,n){super(N.ID,N.LABEL);this.setting=e;this.configService=n;this._register(D.filter(n.onDidChangeConfiguration,i=>i.affectsConfiguration(P))(()=>this.update())),this.update()}static ID="settings.applyToAllProfiles";static LABEL=T("applyToAllProfiles","Apply Setting to all Profiles");update(){const e=this.configService.getValue(P);this.checked=e.includes(this.setting.key)}async run(){const e=this.configService.getValue(P)??[];this.checked?e.splice(e.indexOf(this.setting.key),1):e.push(this.setting.key);const n=It(e);this.checked?(await this.configService.updateValue(this.setting.key,this.configService.inspect(this.setting.key).application?.value,j.USER_LOCAL),await this.configService.updateValue(P,n.length?n:void 0,j.USER_LOCAL)):(await this.configService.updateValue(P,n.length?n:void 0,j.USER_LOCAL),await this.configService.updateValue(this.setting.key,this.configService.inspect(this.setting.key).userLocal?.value,j.USER_LOCAL))}};N=b([m(1,Me)],N);export{p as AbstractSettingRenderer,Hn as NonCollapsibleObjectTreeModel,te as SettingComplexRenderer,U as SettingNewExtensionsRenderer,z as SettingTreeRenderers,ee as SettingsTree,K as SettingsTreeFilter,vn as createSettingMatchRegExp,Mr as createTocTreeForExtensionSettings,wr as resolveConfiguredUntrustedSettings,kr as resolveSettingsTree};
