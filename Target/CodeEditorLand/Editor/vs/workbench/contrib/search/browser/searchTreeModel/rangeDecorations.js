var h=Object.defineProperty;var m=Object.getOwnPropertyDescriptor;var a=(l,e,i,t)=>{for(var o=t>1?void 0:t?m(e,i):e,d=l.length-1,r;d>=0;d--)(r=l[d])&&(o=(t?r(e,i,o):r(o))||o);return t&&o&&h(e,i,o),o},n=(l,e)=>(i,t)=>e(i,t,l);import{DisposableStore as g}from"../../../../../base/common/lifecycle.js";import{URI as p}from"../../../../../base/common/uri.js";import{TrackedRangeStickiness as c}from"../../../../../editor/common/model.js";import{ModelDecorationOptions as _}from"../../../../../editor/common/model/textModel.js";import{IModelService as I}from"../../../../../editor/common/services/model.js";import"../../../../../editor/common/core/range.js";let s=class{constructor(e){this._modelService=e}_decorationId=null;_model=null;_modelDisposables=new g;removeHighlightRange(){if(this._model&&this._decorationId){const e=this._decorationId;this._model.changeDecorations(i=>{i.removeDecoration(e)})}this._decorationId=null}highlightRange(e,i,t=0){let o;p.isUri(e)?o=this._modelService.getModel(e):o=e,o&&this.doHighlightRange(o,i)}doHighlightRange(e,i){this.removeHighlightRange(),e.changeDecorations(t=>{this._decorationId=t.addDecoration(i,s._RANGE_HIGHLIGHT_DECORATION)}),this.setModel(e)}setModel(e){this._model!==e&&(this.clearModelListeners(),this._model=e,this._modelDisposables.add(this._model.onDidChangeDecorations(i=>{this.clearModelListeners(),this.removeHighlightRange(),this._model=null})),this._modelDisposables.add(this._model.onWillDispose(()=>{this.clearModelListeners(),this.removeHighlightRange(),this._model=null})))}clearModelListeners(){this._modelDisposables.clear()}dispose(){this._model&&(this.removeHighlightRange(),this._model=null),this._modelDisposables.dispose()}static _RANGE_HIGHLIGHT_DECORATION=_.register({description:"search-range-highlight",stickiness:c.NeverGrowsWhenTypingAtEdges,className:"rangeHighlight",isWholeLine:!0})};s=a([n(0,I)],s);export{s as RangeHighlightDecorations};
