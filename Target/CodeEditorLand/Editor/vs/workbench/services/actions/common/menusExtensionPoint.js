var N=Object.defineProperty;var q=Object.getOwnPropertyDescriptor;var P=(l,c,r,o)=>{for(var i=o>1?void 0:o?q(c,r):c,m=l.length-1,s;m>=0;m--)(s=l[m])&&(i=(o?s(c,r,i):s(i))||i);return o&&i&&N(c,r,i),i},U=(l,c)=>(r,o)=>c(r,o,l);import{localize as e}from"../../../../nls.js";import{isFalsyOrWhitespace as w}from"../../../../base/common/strings.js";import*as x from"../../../../base/common/resources.js";import"../../../../base/common/jsonSchema.js";import{ExtensionsRegistry as v}from"../../extensions/common/extensionsRegistry.js";import{ContextKeyExpr as F}from"../../../../platform/contextkey/common/contextkey.js";import{MenuId as t,MenuRegistry as T}from"../../../../platform/actions/common/actions.js";import"../../../../base/common/uri.js";import{Disposable as L,DisposableStore as R}from"../../../../base/common/lifecycle.js";import{ThemeIcon as A}from"../../../../base/common/themables.js";import{index as M}from"../../../../base/common/arrays.js";import{isProposedApiEnabled as $}from"../../extensions/common/extensions.js";import"../../../../platform/action/common/action.js";import{Extensions as G}from"../../extensionManagement/common/extensionFeatures.js";import"../../../../platform/extensions/common/extensions.js";import{Registry as H}from"../../../../platform/registry/common/platform.js";import{SyncDescriptor as K}from"../../../../platform/instantiation/common/descriptors.js";import{platform as z}from"../../../../base/common/process.js";import{MarkdownString as O}from"../../../../base/common/htmlContent.js";import"../../../../base/common/keybindings.js";import{IKeybindingService as J}from"../../../../platform/keybinding/common/keybinding.js";import"../../../../platform/extensions/common/extensionsApiProposals.js";const j=[{key:"commandPalette",id:t.CommandPalette,description:e("menus.commandPalette","The Command Palette"),supportsSubmenus:!1},{key:"touchBar",id:t.TouchBarContext,description:e("menus.touchBar","The touch bar (macOS only)"),supportsSubmenus:!1},{key:"editor/title",id:t.EditorTitle,description:e("menus.editorTitle","The editor title menu")},{key:"editor/title/run",id:t.EditorTitleRun,description:e("menus.editorTitleRun","Run submenu inside the editor title menu")},{key:"editor/context",id:t.EditorContext,description:e("menus.editorContext","The editor context menu")},{key:"editor/context/copy",id:t.EditorContextCopy,description:e("menus.editorContextCopyAs","'Copy as' submenu in the editor context menu")},{key:"editor/context/share",id:t.EditorContextShare,description:e("menus.editorContextShare","'Share' submenu in the editor context menu"),proposed:"contribShareMenu"},{key:"explorer/context",id:t.ExplorerContext,description:e("menus.explorerContext","The file explorer context menu")},{key:"explorer/context/share",id:t.ExplorerContextShare,description:e("menus.explorerContextShare","'Share' submenu in the file explorer context menu"),proposed:"contribShareMenu"},{key:"editor/title/context",id:t.EditorTitleContext,description:e("menus.editorTabContext","The editor tabs context menu")},{key:"editor/title/context/share",id:t.EditorTitleContextShare,description:e("menus.editorTitleContextShare","'Share' submenu inside the editor title context menu"),proposed:"contribShareMenu"},{key:"debug/callstack/context",id:t.DebugCallStackContext,description:e("menus.debugCallstackContext","The debug callstack view context menu")},{key:"debug/variables/context",id:t.DebugVariablesContext,description:e("menus.debugVariablesContext","The debug variables view context menu")},{key:"debug/toolBar",id:t.DebugToolBar,description:e("menus.debugToolBar","The debug toolbar menu")},{key:"debug/createConfiguration",id:t.DebugCreateConfiguration,proposed:"contribDebugCreateConfiguration",description:e("menus.debugCreateConfiguation","The debug create configuration menu")},{key:"notebook/variables/context",id:t.NotebookVariablesContext,description:e("menus.notebookVariablesContext","The notebook variables view context menu")},{key:"menuBar/home",id:t.MenubarHomeMenu,description:e("menus.home","The home indicator context menu (web only)"),proposed:"contribMenuBarHome",supportsSubmenus:!1},{key:"menuBar/edit/copy",id:t.MenubarCopy,description:e("menus.opy","'Copy as' submenu in the top level Edit menu")},{key:"scm/title",id:t.SCMTitle,description:e("menus.scmTitle","The Source Control title menu")},{key:"scm/sourceControl",id:t.SCMSourceControl,description:e("menus.scmSourceControl","The Source Control menu")},{key:"scm/sourceControl/title",id:t.SCMSourceControlTitle,description:e("menus.scmSourceControlTitle","The Source Control title menu"),proposed:"contribSourceControlTitleMenu"},{key:"scm/resourceState/context",id:t.SCMResourceContext,description:e("menus.resourceStateContext","The Source Control resource state context menu")},{key:"scm/resourceFolder/context",id:t.SCMResourceFolderContext,description:e("menus.resourceFolderContext","The Source Control resource folder context menu")},{key:"scm/resourceGroup/context",id:t.SCMResourceGroupContext,description:e("menus.resourceGroupContext","The Source Control resource group context menu")},{key:"scm/change/title",id:t.SCMChangeContext,description:e("menus.changeTitle","The Source Control inline change menu")},{key:"scm/inputBox",id:t.SCMInputBox,description:e("menus.input","The Source Control input box menu"),proposed:"contribSourceControlInputBoxMenu"},{key:"scm/history/title",id:t.SCMHistoryTitle,description:e("menus.scmHistoryTitle","The Source Control History title menu"),proposed:"contribSourceControlHistoryTitleMenu"},{key:"scm/historyItem/context",id:t.SCMChangesContext,description:e("menus.historyItemContext","The Source Control history item context menu"),proposed:"contribSourceControlHistoryItemMenu"},{key:"statusBar/remoteIndicator",id:t.StatusBarRemoteIndicatorMenu,description:e("menus.statusBarRemoteIndicator","The remote indicator menu in the status bar"),supportsSubmenus:!1},{key:"terminal/context",id:t.TerminalInstanceContext,description:e("menus.terminalContext","The terminal context menu")},{key:"terminal/title/context",id:t.TerminalTabContext,description:e("menus.terminalTabContext","The terminal tabs context menu")},{key:"view/title",id:t.ViewTitle,description:e("view.viewTitle","The contributed view title menu")},{key:"viewContainer/title",id:t.ViewContainerTitle,description:e("view.containerTitle","The contributed view container title menu"),proposed:"contribViewContainerTitle"},{key:"view/item/context",id:t.ViewItemContext,description:e("view.itemContext","The contributed view item context menu")},{key:"comments/comment/editorActions",id:t.CommentEditorActions,description:e("commentThread.editorActions","The contributed comment editor actions"),proposed:"contribCommentEditorActionsMenu"},{key:"comments/commentThread/title",id:t.CommentThreadTitle,description:e("commentThread.title","The contributed comment thread title menu")},{key:"comments/commentThread/context",id:t.CommentThreadActions,description:e("commentThread.actions","The contributed comment thread context menu, rendered as buttons below the comment editor"),supportsSubmenus:!1},{key:"comments/commentThread/additionalActions",id:t.CommentThreadAdditionalActions,description:e("commentThread.actions","The contributed comment thread context menu, rendered as buttons below the comment editor"),supportsSubmenus:!0,proposed:"contribCommentThreadAdditionalMenu"},{key:"comments/commentThread/title/context",id:t.CommentThreadTitleContext,description:e("commentThread.titleContext","The contributed comment thread title's peek context menu, rendered as a right click menu on the comment thread's peek title."),proposed:"contribCommentPeekContext"},{key:"comments/comment/title",id:t.CommentTitle,description:e("comment.title","The contributed comment title menu")},{key:"comments/comment/context",id:t.CommentActions,description:e("comment.actions","The contributed comment context menu, rendered as buttons below the comment editor"),supportsSubmenus:!1},{key:"comments/commentThread/comment/context",id:t.CommentThreadCommentContext,description:e("comment.commentContext","The contributed comment context menu, rendered as a right click menu on the an individual comment in the comment thread's peek view."),proposed:"contribCommentPeekContext"},{key:"commentsView/commentThread/context",id:t.CommentsViewThreadActions,description:e("commentsView.threadActions","The contributed comment thread context menu in the comments view"),proposed:"contribCommentsViewThreadMenus"},{key:"notebook/toolbar",id:t.NotebookToolbar,description:e("notebook.toolbar","The contributed notebook toolbar menu")},{key:"notebook/kernelSource",id:t.NotebookKernelSource,description:e("notebook.kernelSource","The contributed notebook kernel sources menu"),proposed:"notebookKernelSource"},{key:"notebook/cell/title",id:t.NotebookCellTitle,description:e("notebook.cell.title","The contributed notebook cell title menu")},{key:"notebook/cell/execute",id:t.NotebookCellExecute,description:e("notebook.cell.execute","The contributed notebook cell execution menu")},{key:"interactive/toolbar",id:t.InteractiveToolbar,description:e("interactive.toolbar","The contributed interactive toolbar menu")},{key:"interactive/cell/title",id:t.InteractiveCellTitle,description:e("interactive.cell.title","The contributed interactive cell title menu")},{key:"issue/reporter",id:t.IssueReporter,description:e("issue.reporter","The contributed issue reporter menu"),proposed:"contribIssueReporter"},{key:"testing/item/context",id:t.TestItem,description:e("testing.item.context","The contributed test item menu")},{key:"testing/item/gutter",id:t.TestItemGutter,description:e("testing.item.gutter.title","The menu for a gutter decoration for a test item")},{key:"testing/profiles/context",id:t.TestProfilesContext,description:e("testing.profiles.context.title","The menu for configuring testing profiles.")},{key:"testing/item/result",id:t.TestPeekElement,description:e("testing.item.result.title","The menu for an item in the Test Results view or peek.")},{key:"testing/message/context",id:t.TestMessageContext,description:e("testing.message.context.title","A prominent button overlaying editor content where the message is displayed")},{key:"testing/message/content",id:t.TestMessageContent,description:e("testing.message.content.title","Context menu for the message in the results tree")},{key:"extension/context",id:t.ExtensionContext,description:e("menus.extensionContext","The extension context menu")},{key:"timeline/title",id:t.TimelineTitle,description:e("view.timelineTitle","The Timeline view title menu")},{key:"timeline/item/context",id:t.TimelineItemContext,description:e("view.timelineContext","The Timeline view item context menu")},{key:"ports/item/context",id:t.TunnelContext,description:e("view.tunnelContext","The Ports view item context menu")},{key:"ports/item/origin/inline",id:t.TunnelOriginInline,description:e("view.tunnelOriginInline","The Ports view item origin inline menu")},{key:"ports/item/port/inline",id:t.TunnelPortInline,description:e("view.tunnelPortInline","The Ports view item port inline menu")},{key:"file/newFile",id:t.NewFile,description:e("file.newFile","The 'New File...' quick pick, shown on welcome page and File menu."),supportsSubmenus:!1},{key:"webview/context",id:t.WebviewContext,description:e("webview.context","The webview context menu")},{key:"file/share",id:t.MenubarShare,description:e("menus.share","Share submenu shown in the top level File menu."),proposed:"contribShareMenu"},{key:"editor/inlineCompletions/actions",id:t.InlineCompletionsActions,description:e("inlineCompletions.actions","The actions shown when hovering on an inline completion"),supportsSubmenus:!1,proposed:"inlineCompletionsAdditions"},{key:"editor/inlineEdit/actions",id:t.InlineEditActions,description:e("inlineEdit.actions","The actions shown when hovering on an inline edit"),supportsSubmenus:!1,proposed:"inlineEdit"},{key:"editor/content",id:t.EditorContent,description:e("merge.toolbar","The prominent button in an editor, overlays its content"),proposed:"contribEditorContentMenu"},{key:"editor/lineNumber/context",id:t.EditorLineNumberContext,description:e("editorLineNumberContext","The contributed editor line number context menu")},{key:"mergeEditor/result/title",id:t.MergeInputResultToolbar,description:e("menus.mergeEditorResult","The result toolbar of the merge editor"),proposed:"contribMergeEditorMenus"},{key:"multiDiffEditor/resource/title",id:t.MultiDiffEditorFileToolbar,description:e("menus.multiDiffEditorResource","The resource toolbar in the multi diff editor"),proposed:"contribMultiDiffEditorMenus"},{key:"diffEditor/gutter/hunk",id:t.DiffEditorHunkToolbar,description:e("menus.diffEditorGutterToolBarMenus","The gutter toolbar in the diff editor"),proposed:"contribDiffEditorGutterToolBarMenus"},{key:"diffEditor/gutter/selection",id:t.DiffEditorSelectionToolbar,description:e("menus.diffEditorGutterToolBarMenus","The gutter toolbar in the diff editor"),proposed:"contribDiffEditorGutterToolBarMenus"}];var g;(S=>{function l(n){return typeof n.command=="string"}S.isMenuItem=l;function c(n,u){return typeof n.command!="string"?(u.error(e("requirestring","property `{0}` is mandatory and must be of type `string`","command")),!1):n.alt&&typeof n.alt!="string"?(u.error(e("optstring","property `{0}` can be omitted or must be of type `string`","alt")),!1):n.when&&typeof n.when!="string"?(u.error(e("optstring","property `{0}` can be omitted or must be of type `string`","when")),!1):n.group&&typeof n.group!="string"?(u.error(e("optstring","property `{0}` can be omitted or must be of type `string`","group")),!1):!0}S.isValidMenuItem=c;function r(n,u){return typeof n.submenu!="string"?(u.error(e("requirestring","property `{0}` is mandatory and must be of type `string`","submenu")),!1):n.when&&typeof n.when!="string"?(u.error(e("optstring","property `{0}` can be omitted or must be of type `string`","when")),!1):n.group&&typeof n.group!="string"?(u.error(e("optstring","property `{0}` can be omitted or must be of type `string`","group")),!1):!0}S.isValidSubmenuItem=r;function o(n,u){if(!Array.isArray(n))return u.error(e("requirearray","submenu items must be an array")),!1;for(const y of n)if(l(y)){if(!c(y,u))return!1}else if(!r(y,u))return!1;return!0}S.isValidItems=o;function i(n,u){return typeof n!="object"?(u.error(e("require","submenu items must be an object")),!1):typeof n.id!="string"?(u.error(e("requirestring","property `{0}` is mandatory and must be of type `string`","id")),!1):typeof n.label!="string"?(u.error(e("requirestring","property `{0}` is mandatory and must be of type `string`","label")),!1):!0}S.isValidSubmenu=i;const m={type:"object",required:["command"],properties:{command:{description:e("vscode.extension.contributes.menuItem.command","Identifier of the command to execute. The command must be declared in the 'commands'-section"),type:"string"},alt:{description:e("vscode.extension.contributes.menuItem.alt","Identifier of an alternative command to execute. The command must be declared in the 'commands'-section"),type:"string"},when:{description:e("vscode.extension.contributes.menuItem.when","Condition which must be true to show this item"),type:"string"},group:{description:e("vscode.extension.contributes.menuItem.group","Group into which this item belongs"),type:"string"}}},s={type:"object",required:["submenu"],properties:{submenu:{description:e("vscode.extension.contributes.menuItem.submenu","Identifier of the submenu to display in this item."),type:"string"},when:{description:e("vscode.extension.contributes.menuItem.when","Condition which must be true to show this item"),type:"string"},group:{description:e("vscode.extension.contributes.menuItem.group","Group into which this item belongs"),type:"string"}}},h={type:"object",required:["id","label"],properties:{id:{description:e("vscode.extension.contributes.submenu.id","Identifier of the menu to display as a submenu."),type:"string"},label:{description:e("vscode.extension.contributes.submenu.label","The label of the menu item which leads to this submenu."),type:"string"},icon:{description:e({key:"vscode.extension.contributes.submenu.icon",comment:["do not translate or change `\\$(zap)`, \\ in front of $ is important."]},"(Optional) Icon which is used to represent the submenu in the UI. Either a file path, an object with file paths for dark and light themes, or a theme icon references, like `\\$(zap)`"),anyOf:[{type:"string"},{type:"object",properties:{light:{description:e("vscode.extension.contributes.submenu.icon.light","Icon path when a light theme is used"),type:"string"},dark:{description:e("vscode.extension.contributes.submenu.icon.dark","Icon path when a dark theme is used"),type:"string"}}}]}}};S.menusContribution={description:e("vscode.extension.contributes.menus","Contributes menu items to the editor"),type:"object",properties:M(j,n=>n.key,n=>({markdownDescription:n.proposed?e("proposed",'Proposed API, requires `enabledApiProposal: ["{0}"]` - {1}',n.proposed,n.description):n.description,type:"array",items:n.supportsSubmenus===!1?m:{oneOf:[m,s]}})),additionalProperties:{description:"Submenu",type:"array",items:{oneOf:[m,s]}}},S.submenusContribution={description:e("vscode.extension.contributes.submenus","Contributes submenu items to the editor"),type:"array",items:h};function C(n,u){return n?w(n.command)?(u.error(e("requirestring","property `{0}` is mandatory and must be of type `string`","command")),!1):!p(n.title,u,"title")||n.shortTitle&&!p(n.shortTitle,u,"shortTitle")?!1:n.enablement&&typeof n.enablement!="string"?(u.error(e("optstring","property `{0}` can be omitted or must be of type `string`","precondition")),!1):!(n.category&&!p(n.category,u,"category")||!d(n.icon,u)):(u.error(e("nonempty","expected non-empty value.")),!1)}S.isValidCommand=C;function d(n,u){return typeof n>"u"||typeof n=="string"||typeof n.dark=="string"&&typeof n.light=="string"?!0:(u.error(e("opticon","property `icon` can be omitted or must be either a string or a literal like `{dark, light}`")),!1)}function p(n,u,y){return typeof n>"u"?(u.error(e("requireStringOrObject","property `{0}` is mandatory and must be of type `string` or `object`",y)),!1):typeof n=="string"&&w(n)?(u.error(e("requirestring","property `{0}` is mandatory and must be of type `string`",y)),!1):typeof n!="string"&&(w(n.original)||w(n.value))?(u.error(e("requirestrings","properties `{0}` and `{1}` are mandatory and must be of type `string`",`${y}.value`,`${y}.original`)),!1):!0}const a={type:"object",required:["command","title"],properties:{command:{description:e("vscode.extension.contributes.commandType.command","Identifier of the command to execute"),type:"string"},title:{description:e("vscode.extension.contributes.commandType.title","Title by which the command is represented in the UI"),type:"string"},shortTitle:{markdownDescription:e("vscode.extension.contributes.commandType.shortTitle","(Optional) Short title by which the command is represented in the UI. Menus pick either `title` or `shortTitle` depending on the context in which they show commands."),type:"string"},category:{description:e("vscode.extension.contributes.commandType.category","(Optional) Category string by which the command is grouped in the UI"),type:"string"},enablement:{description:e("vscode.extension.contributes.commandType.precondition","(Optional) Condition which must be true to enable the command in the UI (menu and keybindings). Does not prevent executing the command by other means, like the `executeCommand`-api."),type:"string"},icon:{description:e({key:"vscode.extension.contributes.commandType.icon",comment:["do not translate or change `\\$(zap)`, \\ in front of $ is important."]},"(Optional) Icon which is used to represent the command in the UI. Either a file path, an object with file paths for dark and light themes, or a theme icon references, like `\\$(zap)`"),anyOf:[{type:"string"},{type:"object",properties:{light:{description:e("vscode.extension.contributes.commandType.icon.light","Icon path when a light theme is used"),type:"string"},dark:{description:e("vscode.extension.contributes.commandType.icon.dark","Icon path when a dark theme is used"),type:"string"}}}]}}};S.commandsContribution={description:e("vscode.extension.contributes.commands","Contributes commands to the command palette."),oneOf:[a,{type:"array",items:a}]}})(g||={});const D=new R,_=v.registerExtensionPoint({extensionPoint:"commands",jsonSchema:g.commandsContribution,activationEventsGenerator:(l,c)=>{for(const r of l)r.command&&c.push(`onCommand:${r.command}`)}});_.setHandler(l=>{function c(r,o){if(!g.isValidCommand(r,o.collector))return;const{icon:i,enablement:m,category:s,title:h,shortTitle:b,command:f}=r;let C;i&&(typeof i=="string"?C=A.fromString(i)??{dark:x.joinPath(o.description.extensionLocation,i),light:x.joinPath(o.description.extensionLocation,i)}:C={dark:x.joinPath(o.description.extensionLocation,i.dark),light:x.joinPath(o.description.extensionLocation,i.light)});const d=T.getCommand(f);d&&(d.source?o.collector.info(e("dup1","Command `{0}` already registered by {1} ({2})",r.command,d.source.title,d.source.id)):o.collector.info(e("dup0","Command `{0}` already registered",r.command))),D.add(T.addCommand({id:f,title:h,source:{id:o.description.identifier.value,title:o.description.displayName??o.description.name},shortTitle:b,tooltip:h,category:s,precondition:F.deserialize(m),icon:C}))}D.clear();for(const r of l){const{value:o}=r;if(Array.isArray(o))for(const i of o)c(i,r);else c(o,r)}});const I=new Map,V=v.registerExtensionPoint({extensionPoint:"submenus",jsonSchema:g.submenusContribution});V.setHandler(l=>{I.clear();for(const c of l){const{value:r,collector:o}=c;for(const[,i]of Object.entries(r)){if(!g.isValidSubmenu(i,o))continue;if(!i.id){o.warn(e("submenuId.invalid.id","`{0}` is not a valid submenu identifier",i.id));continue}if(I.has(i.id)){o.info(e("submenuId.duplicate.id","The `{0}` submenu was already previously registered.",i.id));continue}if(!i.label){o.warn(e("submenuId.invalid.label","`{0}` is not a valid submenu label",i.label));continue}let m;i.icon&&(typeof i.icon=="string"?m=A.fromString(i.icon)||{dark:x.joinPath(c.description.extensionLocation,i.icon)}:m={dark:x.joinPath(c.description.extensionLocation,i.icon.dark),light:x.joinPath(c.description.extensionLocation,i.icon.light)});const s={id:t.for(`api:${i.id}`),label:i.label,icon:m};I.set(i.id,s)}}});const W=new Map(j.map(l=>[l.key,l])),B=new R,E=new Map,Q=v.registerExtensionPoint({extensionPoint:"menus",jsonSchema:g.menusContribution,deps:[V]});Q.setHandler(l=>{B.clear(),E.clear();for(const c of l){const{value:r,collector:o}=c;for(const i of Object.entries(r)){if(!g.isValidItems(i[1],o))continue;let m=W.get(i[0]);if(!m){const s=I.get(i[0]);s&&(m={key:i[0],id:s.id,description:""})}if(m){if(m.proposed&&!$(c.description,m.proposed)){o.error(e("proposedAPI.invalid",`{0} is a proposed menu identifier. It requires 'package.json#enabledApiProposals: ["{1}"]' and is only available when running out of dev or with the following command line switch: --enable-proposed-api {2}`,i[0],m.proposed,c.description.identifier.value));continue}for(const s of i[1]){let h;if(g.isMenuItem(s)){const b=T.getCommand(s.command),f=s.alt&&T.getCommand(s.alt)||void 0;if(!b){o.error(e("missing.command","Menu item references a command `{0}` which is not defined in the 'commands' section.",s.command));continue}s.alt&&!f&&o.warn(e("missing.altCommand","Menu item references an alt-command `{0}` which is not defined in the 'commands' section.",s.alt)),s.command===s.alt&&o.info(e("dupe.command","Menu item references the same command as default and alt-command")),h={command:b,alt:f,group:void 0,order:void 0,when:void 0}}else{if(m.supportsSubmenus===!1){o.error(e("unsupported.submenureference","Menu item references a submenu for a menu which doesn't have submenu support."));continue}const b=I.get(s.submenu);if(!b){o.error(e("missing.submenu","Menu item references a submenu `{0}` which is not defined in the 'submenus' section.",s.submenu));continue}let f=E.get(m.id.id);if(f||(f=new Set,E.set(m.id.id,f)),f.has(b.id.id)){o.warn(e("submenuItem.duplicate","The `{0}` submenu was already contributed to the `{1}` menu.",s.submenu,i[0]));continue}f.add(b.id.id),h={submenu:b.id,icon:b.icon,title:b.label,group:void 0,order:void 0,when:void 0}}if(s.group){const b=s.group.lastIndexOf("@");b>0?(h.group=s.group.substr(0,b),h.order=Number(s.group.substr(b+1))||void 0):h.group=s.group}if(m.id===t.ViewContainerTitle&&!s.when?.includes("viewContainer == workbench.view.debug")){o.error(e("viewContainerTitle.when","The {0} menu contribution must check {1} in its {2} clause.","`viewContainer/title`","`viewContainer == workbench.view.debug`",'"when"'));continue}h.when=F.deserialize(s.when),B.add(T.appendMenuItem(m.id,h))}}}}});let k=class extends L{constructor(r){super();this._keybindingService=r}type="table";shouldRender(r){return!!r.contributes?.commands}render(r){const i=(r.contributes?.commands||[]).map(d=>({id:d.command,title:d.title,keybindings:[],menus:[]})),m=M(i,d=>d.id),s=r.contributes?.menus||{},h=M(i,d=>d.id);for(const d of s.commandPalette)delete h[d.command];for(const d in h)s.commandPalette.push({command:d});for(const d in s)for(const p of s[d])if(p.when!=="false"&&p.command){let a=m[p.command];a?a.menus.includes(d)||a.menus.push(d):(a={id:p.command,title:"",keybindings:[],menus:[d]},m[a.id]=a,i.push(a))}if((r.contributes?.keybindings?Array.isArray(r.contributes.keybindings)?r.contributes.keybindings:[r.contributes.keybindings]:[]).forEach(d=>{const p=this.resolveKeybinding(d);if(!p)return;let a=m[d.command];a?a.keybindings.push(p):(a={id:d.command,title:"",keybindings:[p],menus:[]},m[a.id]=a,i.push(a))}),!i.length)return{data:{headers:[],rows:[]},dispose:()=>{}};const f=[e("command name","ID"),e("command title","Title"),e("keyboard shortcuts","Keyboard Shortcuts"),e("menuContexts","Menu Contexts")],C=i.sort((d,p)=>d.id.localeCompare(p.id)).map(d=>[new O().appendMarkdown(`\`${d.id}\``),typeof d.title=="string"?d.title:d.title.value,d.keybindings,new O().appendMarkdown(`${d.menus.sort((p,a)=>p.localeCompare(a)).map(p=>`\`${p}\``).join("&nbsp;")}`)]);return{data:{headers:f,rows:C},dispose:()=>{}}}resolveKeybinding(r){let o;switch(z){case"win32":o=r.win;break;case"linux":o=r.linux;break;case"darwin":o=r.mac;break}return this._keybindingService.resolveUserBinding(o??r.key)[0]}};k=P([U(0,J)],k),H.as(G.ExtensionFeaturesRegistry).registerExtensionFeature({id:"commands",label:e("commands","Commands"),access:{canToggle:!1},renderer:new K(k)});export{_ as commandsExtensionPoint};
