import{EndOfLinePreference as s}from"../../../common/model.js";import"../../../common/core/position.js";import{Range as u}from"../../../common/core/range.js";import{EditorOption as S}from"../../../common/config/editorOptions.js";import"../../../../platform/keybinding/common/keybinding.js";import{AccessibilitySupport as A}from"../../../../platform/accessibility/common/accessibility.js";import*as m from"../../../../nls.js";class b{static _getPageOfLine(e,t){return Math.floor((e-1)/t)}static _getRangeForPage(e,t){const n=e*t,o=n+1,g=n+t;return new u(o,1,g+1,1)}static fromEditorSelection(e,t,n,o){const r=b._getPageOfLine(t.startLineNumber,n),p=b._getRangeForPage(r,n),f=b._getPageOfLine(t.endLineNumber,n),R=b._getRangeForPage(f,n);let a=p.intersectRanges(new u(1,1,t.startLineNumber,t.startColumn));if(o&&e.getValueLengthInRange(a,s.LF)>500){const l=e.modifyPosition(a.getEndPosition(),-500);a=u.fromPositions(l,a.getEndPosition())}const L=e.getValueInRange(a,s.LF),I=e.getLineCount(),h=e.getLineMaxColumn(I);let c=R.intersectRanges(new u(t.endLineNumber,t.endColumn,I,h));if(o&&e.getValueLengthInRange(c,s.LF)>500){const l=e.modifyPosition(c.getStartPosition(),500);c=u.fromPositions(c.getStartPosition(),l)}const C=e.getValueInRange(c,s.LF);let i;if(r===f||r+1===f)i=e.getValueInRange(t,s.LF);else{const l=p.intersectRanges(t),y=R.intersectRanges(t);i=e.getValueInRange(l,s.LF)+"\u2026"+e.getValueInRange(y,s.LF)}return o&&i.length>2*500&&(i=i.substring(0,500)+"\u2026"+i.substring(i.length-500,i.length)),{value:L+i+C,selection:t,selectionStart:L.length,selectionEnd:L.length+i.length,startPositionWithinEditor:a.getStartPosition(),newlineCountBeforeSelection:a.endLineNumber-a.startLineNumber}}}function T(d,e){if(d.get(S.accessibilitySupport)===A.Disabled){const n=e.lookupKeybinding("editor.action.toggleScreenReaderAccessibilityMode")?.getAriaLabel(),o=e.lookupKeybinding("workbench.action.showCommands")?.getAriaLabel(),g=e.lookupKeybinding("workbench.action.openGlobalKeybindings")?.getAriaLabel(),r=m.localize("accessibilityModeOff","The editor is not accessible at this time.");return n?m.localize("accessibilityOffAriaLabel","{0} To enable screen reader optimized mode, use {1}",r,n):o?m.localize("accessibilityOffAriaLabelNoKb","{0} To enable screen reader optimized mode, open the quick pick with {1} and run the command Toggle Screen Reader Accessibility Mode, which is currently not triggerable via keyboard.",r,o):g?m.localize("accessibilityOffAriaLabelNoKbs","{0} Please assign a keybinding for the command Toggle Screen Reader Accessibility Mode by accessing the keybindings editor with {1} and run it.",r,g):r}return d.get(S.ariaLabel)}function k(d){let e=0,t=-1;do{if(t=d.indexOf(`
`,t+1),t===-1)break;e++}while(!0);return e}export{b as PagedScreenReaderStrategy,T as ariaLabelForScreenReaderContent,k as newlinecount};
