import{Codicon as b}from"../../../../base/common/codicons.js";import{KeyCode as n,KeyMod as i}from"../../../../base/common/keyCodes.js";import{MultiCommand as f}from"../../../../editor/browser/editorExtensions.js";import{localize as c}from"../../../../nls.js";import{Action2 as d,MenuId as m,registerAction2 as a}from"../../../../platform/actions/common/actions.js";import{ContextKeyExpr as e}from"../../../../platform/contextkey/common/contextkey.js";import{KeybindingWeight as r}from"../../../../platform/keybinding/common/keybindingsRegistry.js";import{AccessibilityCommandId as l}from"../common/accessibilityCommands.js";import{accessibilityHelpIsShown as u,accessibleViewContainsCodeBlocks as k,accessibleViewCurrentProviderId as g,accessibleViewGoToSymbolSupported as S,accessibleViewHasAssignedKeybindings as H,accessibleViewHasUnassignedKeybindings as x,accessibleViewIsShown as t,accessibleViewSupportsNavigation as v,accessibleViewVerbosityEnabled as P}from"./accessibilityConfiguration.js";import{AccessibleViewProviderId as y,IAccessibleViewService as p}from"../../../../platform/accessibility/browser/accessibleView.js";import{ICodeEditorService as W}from"../../../../editor/browser/services/codeEditorService.js";import{InlineCompletionsController as B}from"../../../../editor/contrib/inlineCompletions/browser/controller/inlineCompletionsController.js";const A={id:m.AccessibleView,group:"navigation",when:t},w={id:m.CommandPalette,group:"",order:1};class O extends d{constructor(){super({id:l.ShowNext,precondition:e.and(t,v),keybinding:{primary:i.Alt|n.BracketRight,weight:r.WorkbenchContrib},menu:[w,{...A,when:e.and(t,v)}],icon:b.arrowDown,title:c("editor.action.accessibleViewNext","Show Next in Accessible View")})}run(o){o.get(p).next()}}a(O);class T extends d{constructor(){super({id:l.NextCodeBlock,precondition:e.and(k,e.or(e.equals(g.key,y.PanelChat),e.equals(g.key,y.InlineChat),e.equals(g.key,y.QuickChat))),keybinding:{primary:i.CtrlCmd|i.Alt|n.PageDown,mac:{primary:i.CtrlCmd|i.Alt|n.PageDown},weight:r.WorkbenchContrib},icon:b.arrowRight,menu:{...A,when:e.and(t,k)},title:c("editor.action.accessibleViewNextCodeBlock","Accessible View: Next Code Block")})}run(o){o.get(p).navigateToCodeBlock("next")}}a(T);class N extends d{constructor(){super({id:l.PreviousCodeBlock,precondition:e.and(k,e.or(e.equals(g.key,y.PanelChat),e.equals(g.key,y.InlineChat),e.equals(g.key,y.QuickChat))),keybinding:{primary:i.CtrlCmd|i.Alt|n.PageUp,mac:{primary:i.CtrlCmd|i.Alt|n.PageUp},weight:r.WorkbenchContrib},icon:b.arrowLeft,menu:{...A,when:e.and(t,k)},title:c("editor.action.accessibleViewPreviousCodeBlock","Accessible View: Previous Code Block")})}run(o){o.get(p).navigateToCodeBlock("previous")}}a(N);class q extends d{constructor(){super({id:l.ShowPrevious,precondition:e.and(t,v),keybinding:{primary:i.Alt|n.BracketLeft,weight:r.WorkbenchContrib},icon:b.arrowUp,menu:[w,{...A,when:e.and(t,v)}],title:c("editor.action.accessibleViewPrevious","Show Previous in Accessible View")})}run(o){o.get(p).previous()}}a(q);class F extends d{constructor(){super({id:l.GoToSymbol,precondition:e.and(e.or(t,u),S),keybinding:{primary:i.CtrlCmd|i.Shift|n.KeyO,secondary:[i.CtrlCmd|i.Shift|n.Period],weight:r.WorkbenchContrib+10},icon:b.symbolMisc,menu:[w,{...A,when:e.and(e.or(t,u),S)}],title:c("editor.action.accessibleViewGoToSymbol","Go To Symbol in Accessible View")})}run(o){o.get(p).goToSymbol()}}a(F);function K(s){return s.register(),s}const oe=K(new f({id:l.OpenAccessibilityHelp,precondition:void 0,kbOpts:{primary:i.Alt|n.F1,weight:r.WorkbenchContrib,linux:{primary:i.Alt|i.Shift|n.F1,secondary:[i.Alt|n.F1]},kbExpr:u.toNegated()},menuOpts:[{menuId:m.CommandPalette,group:"",title:c("editor.action.accessibilityHelp","Open Accessibility Help"),order:1}]})),te=K(new f({id:l.OpenAccessibleView,precondition:void 0,kbOpts:{primary:i.Alt|n.F2,weight:r.WorkbenchContrib,linux:{primary:i.Alt|i.Shift|n.F2,secondary:[i.Alt|n.F2]}},menuOpts:[{menuId:m.CommandPalette,group:"",title:c("editor.action.accessibleView","Open Accessible View"),order:1}]}));class D extends d{constructor(){super({id:l.DisableVerbosityHint,precondition:e.and(e.or(t,u),P),keybinding:{primary:i.Alt|n.F6,weight:r.WorkbenchContrib},icon:b.bellSlash,menu:[w,{id:m.AccessibleView,group:"navigation",when:e.and(e.or(t,u),P)}],title:c("editor.action.accessibleViewDisableHint","Disable Accessible View Hint")})}run(o){o.get(p).disableHint()}}a(D);class E extends d{constructor(){super({id:l.AccessibilityHelpConfigureKeybindings,precondition:e.and(u,x),icon:b.key,keybinding:{primary:i.Alt|n.KeyK,weight:r.WorkbenchContrib},menu:[{id:m.AccessibleView,group:"navigation",order:3,when:x}],title:c("editor.action.accessibilityHelpConfigureUnassignedKeybindings","Accessibility Help Configure Unassigned Keybindings")})}async run(o){await o.get(p).configureKeybindings(!0)}}a(E);class L extends d{constructor(){super({id:l.AccessibilityHelpConfigureAssignedKeybindings,precondition:e.and(u,H),icon:b.key,keybinding:{primary:i.Alt|n.KeyA,weight:r.WorkbenchContrib},menu:[{id:m.AccessibleView,group:"navigation",order:4,when:H}],title:c("editor.action.accessibilityHelpConfigureAssignedKeybindings","Accessibility Help Configure Assigned Keybindings")})}async run(o){await o.get(p).configureKeybindings(!1)}}a(L);class U extends d{constructor(){super({id:l.AccessibilityHelpOpenHelpLink,precondition:e.and(u),keybinding:{primary:i.Alt|n.KeyH,weight:r.WorkbenchContrib},title:c("editor.action.accessibilityHelpOpenHelpLink","Accessibility Help Open Help Link")})}run(o){o.get(p).openHelpLink()}}a(U);class G extends d{constructor(){super({id:l.AccessibleViewAcceptInlineCompletion,precondition:e.and(t,e.equals(g.key,y.InlineCompletions)),keybinding:{primary:i.CtrlCmd|n.Slash,mac:{primary:i.WinCtrl|n.Slash},weight:r.WorkbenchContrib},icon:b.check,menu:[w,{id:m.AccessibleView,group:"navigation",order:0,when:e.and(t,e.equals(g.key,y.InlineCompletions))}],title:c("editor.action.accessibleViewAcceptInlineCompletionAction","Accept Inline Completion")})}async run(o){const V=o.get(W),C=V.getActiveCodeEditor()||V.getFocusedCodeEditor();if(!C)return;const h=B.get(C)?.model.get(),I=h?.state.get();!h||!I||(await h.accept(C),h.stop(),C.focus())}}a(G);export{oe as AccessibilityHelpAction,te as AccessibleViewAction};
